<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Logger.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Data.h&quot;</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Data.h&quot;</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Packet</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">captured</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">doneCounting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">quotes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="s">&quot;Less Cheese = More Cheese&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;A man chooses, a slave obeys&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;*sigh* i guess you are my little pugchamp&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;made with &lt;3&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;where are my pants?&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;Spain but the S is silent&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;now with 5 percent more Bob Ross!&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;I hardly know &#39;er!&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;How you BEAN?&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;You&#39;re breathtaking!&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;The embodiment of page 2 of google search results&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;Love is like frying food shirtless, you never know when it&#39;s going to hurt&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;Water is just hydrogen soup&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;Hey, got any grapes?&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;&#39;Hello there, old sport!&#39; - an aubergine colored individual&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;I don&#39;t get why circles exist. They&#39;re pointless.&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;I&#39;m afraid for the calendar. Its days are numbered.&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;If the USA is so great why did they make a USB?&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;Why are ducks always in a fowl mood?&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;it is Wednesday my dudes&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;Approved by official code bros&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;&#39;If it compiles, it&#39;s good; if it boots up, it&#39;s perfect.&#39; - Linus Torvalds, Finnish Software Chad&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;It Just Works.&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;gotta love it when asynchronization works 60 percent out of 5 percent of the time&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;The numbers Mason! What do they mean?!?!&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;funny quote go brrrrr&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;Built by a part time silly sandwich&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;&#39;Give someone state and they&#39;ll have a bug one day, but teach them how to represent state in two separate locations that have to be kept in sync and they&#39;ll have bugs for a lifetime.&#39; - ryg&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;Panem et Circenses&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;this quote has been left as an exercise for the reader&quot;</span>
<span class="p">};</span>
<span class="kt">long</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">epochStart</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">dscpMap</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">ecnMap</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">doneCapturing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">capturedLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">showStop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">showStart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">captureThread</span><span class="p">;</span>
<span class="n">pcap_t</span><span class="o">*</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">chosenAdapter</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">guard</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Data::init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Default&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF11&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF12&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF13&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF21&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF22&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF23&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF31&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF32&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF33&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF41&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">36</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF42&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">38</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AF43&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CS1&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CS2&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CS3&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CS4&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">40</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CS5&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">48</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CS6&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">56</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CS7&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">dscpMap</span><span class="p">[</span><span class="mi">46</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;EF&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="n">ecnMap</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Not-ECT&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">ecnMap</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ECT(1)&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">ecnMap</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ECT(0)&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">ecnMap</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CE&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Data::addPacket</span><span class="p">(</span><span class="n">Packet</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">captured</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../Networks/Packets/Types/Types.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;thread&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;mutex&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Data</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Packet</span><span class="o">*&gt;</span><span class="w">              </span><span class="n">captured</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w">                               </span><span class="n">selected</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w">                              </span><span class="n">doneCounting</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="o">&gt;</span><span class="w">       </span><span class="n">quotes</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">double</span><span class="w">                       </span><span class="n">epochStart</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dscpMap</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ecnMap</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">doneCapturing</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">capturedLength</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">showStop</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">showStart</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="w"> </span><span class="n">captureThread</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">pcap_t</span><span class="o">*</span><span class="w"> </span><span class="n">chosenAdapter</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">selectExpand</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="w"> </span><span class="n">guard</span><span class="p">;</span>

<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addPacket</span><span class="p">(</span><span class="n">Packet</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Logger.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="n">std</span><span class="o">::</span><span class="n">ofstream</span><span class="w"> </span><span class="n">Logger</span><span class="o">::</span><span class="n">m_file</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Logger::init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ofstream</span><span class="p">(</span><span class="s">&quot;log.txt&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Logger::log</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;log: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">	</span><span class="n">m_file</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Logger::release</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_file</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fstream&gt;</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// Static logging class</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Logger</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="c1">// club pinguin is kil</span>
<span class="w">	</span><span class="c1">// no</span>
<span class="w">	</span><span class="n">Logger</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
<span class="w">	</span><span class="c1">/// &lt;summary&gt;</span>
<span class="w">	</span><span class="c1">/// init the logger</span>
<span class="w">	</span><span class="c1">/// &lt;/summary&gt;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">();</span>
<span class="w">	</span><span class="c1">/// &lt;summary&gt;</span>
<span class="w">	</span><span class="c1">/// log the string to the file and print it on the console for debugging</span>
<span class="w">	</span><span class="c1">/// &lt;/summary&gt;</span>
<span class="w">	</span><span class="c1">/// &lt;param name=&quot;str&quot;&gt;- the string to log&lt;/param&gt;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>
<span class="w">	</span><span class="c1">/// &lt;summary&gt;</span>
<span class="w">	</span><span class="c1">/// free the deugger and release the log file</span>
<span class="w">	</span><span class="c1">/// &lt;/summary&gt;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">release</span><span class="p">();</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">	</span><span class="c1">/// &lt;summary&gt;</span>
<span class="w">	</span><span class="c1">///</span>
<span class="w">	</span><span class="c1">/// &lt;/summary&gt;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ofstream</span><span class="w"> </span><span class="n">m_file</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GUI.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;ImageLoader.h&quot;</span>

<span class="n">GLFWwindow</span><span class="o">*</span><span class="w"> </span><span class="n">GUI</span><span class="o">::</span><span class="n">window</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">ImFont</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">GUI</span><span class="o">::</span><span class="n">fonts</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">GUI::init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">glfwInit</span><span class="p">())</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">-1</span><span class="p">);</span>

<span class="w">	</span><span class="n">glfwWindowHint</span><span class="p">(</span><span class="n">GLFW_RESIZABLE</span><span class="p">,</span><span class="w"> </span><span class="n">GLFW_FALSE</span><span class="p">);</span>
<span class="w">	</span><span class="n">glfwWindowHint</span><span class="p">(</span><span class="n">GLFW_REFRESH_RATE</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>

<span class="w">	</span><span class="n">window</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glfwCreateWindow</span><span class="p">(</span><span class="mi">1280</span><span class="p">,</span><span class="w"> </span><span class="mi">720</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;RustyDolphin&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">window</span><span class="p">)</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="n">glfwTerminate</span><span class="p">();</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">-1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">glfwMakeContextCurrent</span><span class="p">(</span><span class="n">window</span><span class="p">);</span>

<span class="w">	</span><span class="n">GLFWimage</span><span class="w"> </span><span class="n">images</span><span class="p">[</span><span class="mi">1</span><span class="p">]{};</span>
<span class="w">	</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">pixels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stbi_load</span><span class="p">(</span><span class="s">&quot;deps/assets/icon.png&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">height</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w"> </span><span class="c1">//rgba channels</span>
<span class="w">	</span><span class="n">glfwSetWindowIcon</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">images</span><span class="p">);</span>
<span class="w">	</span><span class="n">stbi_image_free</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">pixels</span><span class="p">);</span>

<span class="w">	</span><span class="c1">// Initialize Dear ImGui</span>
<span class="w">	</span><span class="n">IMGUI_CHECKVERSION</span><span class="p">();</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">CreateContext</span><span class="p">();</span>

<span class="w">	</span><span class="c1">// Set Dear ImGui style</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">StyleColorsDark</span><span class="p">();</span>

<span class="w">	</span><span class="c1">// Initialize Dear ImGui backends</span>
<span class="w">	</span><span class="n">ImGui_ImplGlfw_InitForOpenGL</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui_ImplOpenGL3_Init</span><span class="p">(</span><span class="s">&quot;#version 150&quot;</span><span class="p">);</span>

<span class="w">	</span><span class="c1">//// Get the font atlas</span>
<span class="w">	</span><span class="c1">//ImGuiIO&amp; io = ImGui::GetIO();</span>
<span class="w">	</span><span class="c1">//ImFontAtlas* atlas = io.Fonts;</span>

<span class="w">	</span><span class="c1">//// Clear the current fonts</span>
<span class="w">	</span><span class="c1">//atlas-&gt;Clear();</span>

<span class="w">	</span><span class="c1">//// Add a single font</span>
<span class="w">	</span><span class="c1">//atlas-&gt;AddFontDefault();</span>

<span class="w">	</span><span class="c1">//atlas-&gt;Flags |= ImFontAtlasFlags_NoPowerOfTwoHeight;</span>

<span class="w">	</span><span class="c1">//// Build the font atlas</span>
<span class="w">	</span><span class="c1">//atlas-&gt;Build();</span>

<span class="w">	</span><span class="n">ImGuiIO</span><span class="o">&amp;</span><span class="w"> </span><span class="n">io</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImGui</span><span class="o">::</span><span class="n">GetIO</span><span class="p">();</span>

<span class="w">	</span><span class="n">fonts</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;title&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">Fonts</span><span class="o">-&gt;</span><span class="n">AddFontFromFileTTF</span><span class="p">(</span><span class="s">&quot;deps/fonts/arial.ttf&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="n">fonts</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;quote&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">Fonts</span><span class="o">-&gt;</span><span class="n">AddFontFromFileTTF</span><span class="p">(</span><span class="s">&quot;deps/fonts/arial.ttf&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="n">fonts</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;adapters&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">Fonts</span><span class="o">-&gt;</span><span class="n">AddFontFromFileTTF</span><span class="p">(</span><span class="s">&quot;deps/fonts/arial.ttf&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="n">fonts</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;regular&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">Fonts</span><span class="o">-&gt;</span><span class="n">AddFontFromFileTTF</span><span class="p">(</span><span class="s">&quot;deps/fonts/arial.ttf&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="n">fonts</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;hexView&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">Fonts</span><span class="o">-&gt;</span><span class="n">AddFontFromFileTTF</span><span class="p">(</span><span class="s">&quot;deps/fonts/consola.ttf&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="n">io</span><span class="p">.</span><span class="n">Fonts</span><span class="o">-&gt;</span><span class="n">Build</span><span class="p">();</span>

<span class="w">	</span><span class="n">glfwSwapInterval</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="w">	</span><span class="n">ImGuiStyle</span><span class="o">&amp;</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImGui</span><span class="o">::</span><span class="n">GetStyle</span><span class="p">();</span>
<span class="w">	</span><span class="n">style</span><span class="p">.</span><span class="n">Colors</span><span class="p">[</span><span class="n">ImGuiCol_Button</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImVec4</span><span class="p">(</span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">);</span>
<span class="w">	</span><span class="n">style</span><span class="p">.</span><span class="n">Colors</span><span class="p">[</span><span class="n">ImGuiCol_ButtonHovered</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImVec4</span><span class="p">(</span><span class="mf">0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">GUI::release</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// Cleanup</span>
<span class="w">	</span><span class="n">ImGui_ImplOpenGL3_Shutdown</span><span class="p">();</span>
<span class="w">	</span><span class="n">ImGui_ImplGlfw_Shutdown</span><span class="p">();</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">DestroyContext</span><span class="p">();</span>

<span class="w">	</span><span class="n">glfwTerminate</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">GUI::pushFont</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">PushFont</span><span class="p">(</span><span class="n">fonts</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">name</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">GUI::popFont</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">PopFont</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">GUI::centerText</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">windowWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImGui</span><span class="o">::</span><span class="n">GetWindowSize</span><span class="p">().</span><span class="n">x</span><span class="p">;</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">textWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImGui</span><span class="o">::</span><span class="n">CalcTextSize</span><span class="p">(</span><span class="n">text</span><span class="p">).</span><span class="n">x</span><span class="p">;</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosX</span><span class="p">((</span><span class="n">windowWidth</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">textWidth</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span><span class="w"> </span><span class="nf">GUI::centerButton</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">windowWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImGui</span><span class="o">::</span><span class="n">GetWindowSize</span><span class="p">().</span><span class="n">x</span><span class="p">;</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">textWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImGui</span><span class="o">::</span><span class="n">CalcTextSize</span><span class="p">(</span><span class="n">text</span><span class="p">).</span><span class="n">x</span><span class="p">;</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosX</span><span class="p">((</span><span class="n">windowWidth</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">textWidth</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">);</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#define IMGUI_USE_STB_SPRINTF</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;GLFW/glfw3.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;imgui.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;imgui_impl_glfw.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;imgui_impl_opengl3.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;map&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GUI</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">GLFWwindow</span><span class="o">*</span><span class="w"> </span><span class="n">window</span><span class="p">;</span>

<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">release</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">pushFont</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">popFont</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">centerText</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">text</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">centerButton</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">text</span><span class="p">);</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">ImFont</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">fonts</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#define STB_IMAGE_IMPLEMENTATION</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;stb_image.h&quot;</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Renderer.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../Base/Data.h&quot;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">Packet</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_phySrc</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_phyDst</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::renderExpanded</span><span class="p">(</span><span class="n">Packet</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">getTexts</span><span class="p">();</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="n">map</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;title&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;Packet Title&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;Packet Title&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;Packet Title&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Arrival time: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;time&quot;</span><span class="p">)).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Destination: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_phyDst</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Source: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_phySrc</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Type: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">ARP</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_phySrc</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_phyDst</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;ARP&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::renderExpanded</span><span class="p">(</span><span class="n">ARP</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">renderExpanded</span><span class="p">((</span><span class="n">Packet</span><span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">);</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">getTexts</span><span class="p">();</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="n">map</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;arpTitle&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ARP Title&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ARP Title&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ARP Title&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Hardware type: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;hardType&quot;</span><span class="p">)).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Protocol type: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;protoType&quot;</span><span class="p">)).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Hardware size: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_hardSize</span><span class="p">)).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Protocol size: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_protoSize</span><span class="p">)).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Opcode: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;opcode&quot;</span><span class="p">)).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Sender MAC Address: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_sendMAC</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Sender IP Address: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_sendAddr</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Target MAC Address: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_targetMAC</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Target IP Address: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_targetAddr</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">IPV4</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_srcAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_destAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::renderExpanded</span><span class="p">(</span><span class="n">IPV4</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">renderExpanded</span><span class="p">((</span><span class="n">Packet</span><span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">);</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">getTexts</span><span class="p">();</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IPTitle&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IPV4 Title&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IPV4 Title&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IPV4 Title&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">0100 .... = Version 4&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;headerLen&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;differServ&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;DifferServ&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;DifferServ&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;DifferServ&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;DSCP&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ECN&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Total Length: %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_totalLength</span><span class="p">);</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ID&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IPFlags&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;Flags&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;Flags&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;Flags&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;resBits&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;dfBits&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;mfBits&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;offset&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Time to Live: %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_ttl</span><span class="p">);</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;proto&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IPChecksum&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;src&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;dest&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_IPoptionsCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;optStr&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;Options General&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;Options General&quot;</span><span class="p">);</span>
<span class="w">			</span><span class="p">}</span>

<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;Options General&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_optButtons</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="k">auto</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_optButtons</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">					</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">c_str</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">						</span>
<span class="w">						</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;option %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;option %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">));</span>
<span class="w">					</span><span class="p">}</span>

<span class="w">					</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;option %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">						</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_opts</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">							</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">						</span><span class="p">}</span>
<span class="w">					</span><span class="p">}</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">IPV6</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_srcAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_destAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">TCP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_srcAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_destAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::renderExpanded</span><span class="p">(</span><span class="n">TCP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">renderExpanded</span><span class="p">((</span><span class="n">IPV4</span><span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">);</span>

<span class="w">	</span><span class="cm">/*if (ImGui::Button(p-&gt;m_TCPTitle.c_str())) {</span>
<span class="cm">		p-&gt;m_expands.at(&quot;TCP Title&quot;) = !p-&gt;m_expands.at(&quot;TCP Title&quot;);</span>
<span class="cm">	}</span>

<span class="cm">	if (p-&gt;m_expands.at(&quot;TCP Title&quot;)) {</span>

<span class="cm">	}*/</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">TCP</span><span class="o">&lt;</span><span class="n">IPV6</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_srcAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_destAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">UDP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_srcAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_destAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">UDP</span><span class="o">&lt;</span><span class="n">IPV6</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_srcAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_destAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">ICMP</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_srcAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_destAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::renderExpanded</span><span class="p">(</span><span class="n">ICMP</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">renderExpanded</span><span class="p">((</span><span class="n">IPV4</span><span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">);</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">getTexts</span><span class="p">();</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="s">&quot;Internet Control Message Control&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMP Title&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMP Title&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMP Title&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMPType&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMPCode&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMPChecksum&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IDBE&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IDLE&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;SNBE&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;SNLE&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMPDataHeader&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMP Data&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMP Data&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMP Data&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;ICMPData&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">ICMPV6</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_srcAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_destAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>


<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::render</span><span class="p">(</span><span class="n">IGMP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Selectable</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idxStr</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiSelectableFlags_SpanAllColumns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_srcAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_destAddr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_strType</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_len</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetColumnIndex</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_description</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Renderer::renderExpanded</span><span class="p">(</span><span class="n">IGMP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">renderExpanded</span><span class="p">((</span><span class="n">IPV4</span><span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">);</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">getTexts</span><span class="p">();</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="s">&quot;Internet Group Management Protocol&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IGMP Title&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IGMP Title&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">m_expands</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IGMP Title&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IGMPType&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;respTime&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;IGMPChecksum&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;multicastAddr&quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#define IMGUI_USE_STB_SPRINTF</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GUI.h&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Packet</span><span class="p">;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ARP</span><span class="p">;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IPV4</span><span class="p">;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IPV6</span><span class="p">;</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TCP</span><span class="p">;</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UDP</span><span class="p">;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ICMP</span><span class="p">;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ICMPV6</span><span class="p">;</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IGMP</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Renderer</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">render</span><span class="p">(</span><span class="n">Packet</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">renderExpanded</span><span class="p">(</span><span class="n">Packet</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">ARP</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">renderExpanded</span><span class="p">(</span><span class="n">ARP</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">IPV4</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">renderExpanded</span><span class="p">(</span><span class="n">IPV4</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">IGMP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">renderExpanded</span><span class="p">(</span><span class="n">IGMP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">TCP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">renderExpanded</span><span class="p">(</span><span class="n">TCP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">ICMP</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">renderExpanded</span><span class="p">(</span><span class="n">ICMP</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">UDP</span><span class="o">&lt;</span><span class="n">IPV6</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">IPV6</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">TCP</span><span class="o">&lt;</span><span class="n">IPV6</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">UDP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">ICMPV6</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#define _WINSOCK_DEPRECATED_NO_WARNINGS</span>
<span class="cp">#define STB_IMAGE_WRITE_IMPLEMENTATION</span>
<span class="cp">#define _CRT_SECURE_NO_WARNINGS</span>
<span class="cp">#define IMGUI_USE_STB_SPRINTF</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdio&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Winsock2.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Windows.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Base/Base.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Networks/Networks.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Win/Win.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdint&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;GLFW/glfw3.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;imgui.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;imgui_impl_glfw.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;imgui_impl_opengl3.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;GLFW/glfw3native.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;GUI/GUI.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;ImGuiFileDialog.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;shellapi.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;thread&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;mutex&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">release</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">Data</span><span class="o">::</span><span class="n">doneCounting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">	</span><span class="n">Data</span><span class="o">::</span><span class="n">doneCapturing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">	</span><span class="n">Logger</span><span class="o">::</span><span class="n">release</span><span class="p">();</span>
<span class="w">	</span><span class="n">Capture</span><span class="o">::</span><span class="n">release</span><span class="p">();</span>
<span class="w">	</span><span class="n">SDK</span><span class="o">::</span><span class="n">release</span><span class="p">();</span>
<span class="w">	</span><span class="n">GUI</span><span class="o">::</span><span class="n">release</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">atexit</span><span class="p">(</span><span class="n">release</span><span class="p">);</span>
<span class="w">	</span><span class="n">Data</span><span class="o">::</span><span class="n">init</span><span class="p">();</span>
<span class="w">	</span><span class="n">Logger</span><span class="o">::</span><span class="n">init</span><span class="p">();</span>
<span class="w">	</span><span class="n">Capture</span><span class="o">::</span><span class="n">init</span><span class="p">();</span>
<span class="w">	</span><span class="n">SDK</span><span class="o">::</span><span class="n">init</span><span class="p">();</span>
<span class="w">	</span><span class="n">GUI</span><span class="o">::</span><span class="n">init</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">countPackets</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">counts</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">adapterIdx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">getDev</span><span class="p">(</span><span class="n">adapterIdx</span><span class="p">);</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">adhandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">createAdapter</span><span class="p">(</span><span class="n">adapterIdx</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="w">	</span><span class="k">struct</span><span class="w"> </span><span class="nc">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">;</span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>

<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcap_next_ex</span><span class="p">(</span><span class="n">adhandle</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pkt_data</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Data</span><span class="o">::</span><span class="n">doneCounting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">continue</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">counts</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">adapterIdx</span><span class="p">)</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">pcap_close</span><span class="p">(</span><span class="n">adhandle</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fromRaw</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>

<span class="w">	</span><span class="c1">//if (idx == 982) {</span>
<span class="w">	</span><span class="c1">//	p = fromRaw(header, pkt_data, idx);</span>
<span class="w">	</span><span class="c1">//	std::size_t pos = filename.find(&#39;.&#39;);</span>
<span class="w">	</span><span class="c1">//	if (pos != std::string::npos) {</span>
<span class="w">	</span><span class="c1">//		filename.erase(pos);</span>
<span class="w">	</span><span class="c1">//	}</span>

<span class="w">	</span><span class="c1">//	std::ofstream file(filename + &quot;.txt&quot;, std::ios_base::app);</span>

<span class="w">	</span><span class="c1">//	if (!file) {</span>
<span class="w">	</span><span class="c1">//		std::cerr &lt;&lt; &quot;Error opening file: &quot; &lt;&lt; filename + &quot;.txt&quot; &lt;&lt; &#39;\n&#39;;</span>
<span class="w">	</span><span class="c1">//		exit(69);</span>
<span class="w">	</span><span class="c1">//	}</span>

<span class="w">	</span><span class="c1">//	file &lt;&lt; p-&gt;jsonify().dump(4) &lt;&lt; &quot;\n&quot;;</span>

<span class="w">	</span><span class="c1">//	 std::cout &lt;&lt; p-&gt;jsonify().dump(4) &lt;&lt; std::endl;</span>

<span class="w">	</span><span class="c1">//	 std::cout &lt;&lt; p-&gt;toString() &lt;&lt; std::endl;</span>
<span class="w">	</span><span class="c1">//	/*std::cout &lt;&lt; &quot;hey:&quot; &lt;&lt; std::endl;</span>
<span class="w">	</span><span class="c1">//	for (int i = 0; i &lt; p-&gt;m_len; i++) {</span>
<span class="w">	</span><span class="c1">//		std::cout &lt;&lt; std::hex &lt;&lt; (int)p-&gt;m_pktData[i];</span>
<span class="w">	</span><span class="c1">//	}*/</span>
<span class="w">	</span><span class="c1">//}</span>

<span class="w">	</span><span class="n">Data</span><span class="o">::</span><span class="n">addPacket</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">pcap_t</span><span class="o">*</span><span class="w"> </span><span class="nf">getAdapter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="cp">#ifdef _DEBUG</span>
<span class="w">	</span><span class="c1">//return Capture::load(&quot;samples.pcapng&quot;);</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">createAdapter</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="w">	</span><span class="k">using</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">high_resolution_clock</span><span class="p">;</span>
<span class="w">	</span><span class="k">using</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">duration_cast</span><span class="p">;</span>
<span class="w">	</span><span class="k">using</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">duration</span><span class="p">;</span>
<span class="w">	</span><span class="k">using</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">milliseconds</span><span class="p">;</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">getDeviceNames</span><span class="p">();</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">counts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">names</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">threads</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="o">*&gt;</span><span class="p">();</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">names</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">threads</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="p">(</span><span class="n">countPackets</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">counts</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">));</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">randomNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">quotes</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rates</span><span class="p">;</span>

<span class="w">	</span><span class="n">rates</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">names</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">);</span>

<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>

<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">Data</span><span class="o">::</span><span class="n">doneCounting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="c1">// Poll and handle events</span>
<span class="w">		</span><span class="n">glfwPollEvents</span><span class="p">();</span>

<span class="w">		</span><span class="c1">// Start the Dear ImGui frame</span>
<span class="w">		</span><span class="n">ImGui_ImplOpenGL3_NewFrame</span><span class="p">();</span>
<span class="w">		</span><span class="n">ImGui_ImplGlfw_NewFrame</span><span class="p">();</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">NewFrame</span><span class="p">();</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">glfwWindowShouldClose</span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">window</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowPos</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowSize</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">1280</span><span class="p">,</span><span class="w"> </span><span class="mi">720</span><span class="p">));</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Begin</span><span class="p">(</span><span class="s">&quot;Adapter Selection Window&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoResize</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoMove</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoCollapse</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoTitleBar</span><span class="p">);</span>

<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPos</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">340</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>
<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">pushFont</span><span class="p">(</span><span class="s">&quot;title&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerText</span><span class="p">(</span><span class="s">&quot;Welcome to RustyDolphin&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">popFont</span><span class="p">();</span>

<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">pushFont</span><span class="p">(</span><span class="s">&quot;quote&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerText</span><span class="p">(</span><span class="n">Data</span><span class="o">::</span><span class="n">quotes</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">randomNumber</span><span class="p">));</span>
<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">popFont</span><span class="p">();</span>

<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">pushFont</span><span class="p">(</span><span class="s">&quot;adapters&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosY</span><span class="p">(</span><span class="mi">150</span><span class="p">);</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Choose the adapter you&#39;d like to use:&quot;</span><span class="p">);</span>

<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">ms_int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">milliseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">t2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t1</span><span class="p">);</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">secs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">ms_int</span><span class="p">.</span><span class="n">count</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">secs</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="n">last</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">5.0</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">rates</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="n">rates</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="kt">float</span><span class="p">)</span><span class="n">counts</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">secs</span><span class="p">);</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">			</span><span class="n">last</span><span class="o">++</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">names</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosX</span><span class="p">(</span><span class="mi">150</span><span class="p">);</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">names</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; (Packet Rate: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">rates</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; per second)&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Button</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">().</span><span class="n">c_str</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">			</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">selected</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">OpenPopup</span><span class="p">(</span><span class="s">&quot;AdapterSelectPopup&quot;</span><span class="p">);</span>

<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowSize</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">));</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowPos</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">640</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">360</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">250</span><span class="p">));</span>
<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">BeginPopupModal</span><span class="p">(</span><span class="s">&quot;AdapterSelectPopup&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoResize</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoMove</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoTitleBar</span><span class="p">))</span>
<span class="w">			</span><span class="p">{</span>
<span class="w">				</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerText</span><span class="p">(</span><span class="s">&quot;Are you sure you want this adapter?&quot;</span><span class="p">);</span>
<span class="w">				</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosY</span><span class="p">(</span><span class="mi">350</span><span class="p">);</span>
<span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerButton</span><span class="p">(</span><span class="s">&quot;Yes&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="n">Data</span><span class="o">::</span><span class="n">doneCounting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">					</span><span class="n">GUI</span><span class="o">::</span><span class="n">popFont</span><span class="p">();</span>
<span class="w">					</span><span class="n">ImGui</span><span class="o">::</span><span class="n">EndPopup</span><span class="p">();</span>
<span class="w">					</span><span class="n">ImGui</span><span class="o">::</span><span class="n">End</span><span class="p">();</span>

<span class="w">					</span><span class="c1">// auto io = ImGui::GetIO();</span>

<span class="w">					</span><span class="c1">// std::cout &lt;&lt; io.Framerate &lt;&lt; &quot; FPS\n&quot;;</span>

<span class="w">					</span><span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span><span class="p">);</span>
<span class="w">					</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Render</span><span class="p">();</span>
<span class="w">					</span><span class="n">ImGui_ImplOpenGL3_RenderDrawData</span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">GetDrawData</span><span class="p">());</span>
<span class="w">					</span><span class="n">glfwSwapBuffers</span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">window</span><span class="p">);</span>
<span class="w">					</span><span class="k">break</span><span class="p">;</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">				</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosY</span><span class="p">(</span><span class="mi">430</span><span class="p">);</span>
<span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerButton</span><span class="p">(</span><span class="s">&quot;No&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">					</span><span class="n">ImGui</span><span class="o">::</span><span class="n">CloseCurrentPopup</span><span class="p">();</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">				</span><span class="n">ImGui</span><span class="o">::</span><span class="n">EndPopup</span><span class="p">();</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">popFont</span><span class="p">();</span>

<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">End</span><span class="p">();</span>

<span class="w">		</span><span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span><span class="p">);</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Render</span><span class="p">();</span>
<span class="w">		</span><span class="n">ImGui_ImplOpenGL3_RenderDrawData</span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">GetDrawData</span><span class="p">());</span>
<span class="w">		</span><span class="n">glfwSwapBuffers</span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">window</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">for_each</span><span class="p">(</span><span class="n">threads</span><span class="p">.</span><span class="n">cbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">threads</span><span class="p">.</span><span class="n">cend</span><span class="p">(),</span><span class="w"> </span><span class="p">[](</span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">t</span><span class="o">-&gt;</span><span class="n">join</span><span class="p">();</span><span class="w"> </span><span class="p">});</span>

<span class="w">	</span><span class="n">SDK</span><span class="o">::</span><span class="n">findIP</span><span class="p">(</span><span class="n">Capture</span><span class="o">::</span><span class="n">getDev</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">createAdapter</span><span class="p">(</span><span class="n">selected</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">handleStop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">GUI</span><span class="o">::</span><span class="n">pushFont</span><span class="p">(</span><span class="s">&quot;adapters&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">OpenPopup</span><span class="p">(</span><span class="s">&quot;StopCapture&quot;</span><span class="p">);</span>

<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowSize</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">));</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowPos</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">640</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">360</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">250</span><span class="p">));</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">BeginPopupModal</span><span class="p">(</span><span class="s">&quot;StopCapture&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoResize</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoMove</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoTitleBar</span><span class="p">))</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerText</span><span class="p">(</span><span class="s">&quot;Are you sure you want stop the current capture?&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosY</span><span class="p">(</span><span class="mi">350</span><span class="p">);</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerButton</span><span class="p">(</span><span class="s">&quot;Yes&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">doneCapturing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">showStop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosY</span><span class="p">(</span><span class="mi">430</span><span class="p">);</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerButton</span><span class="p">(</span><span class="s">&quot;No&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">showStop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">EndPopup</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">GUI</span><span class="o">::</span><span class="n">popFont</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">handleStart</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">GUI</span><span class="o">::</span><span class="n">pushFont</span><span class="p">(</span><span class="s">&quot;adapters&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">OpenPopup</span><span class="p">(</span><span class="s">&quot;StartCapture&quot;</span><span class="p">);</span>

<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowSize</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">));</span>
<span class="w">	</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowPos</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">640</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">360</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">250</span><span class="p">));</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">BeginPopupModal</span><span class="p">(</span><span class="s">&quot;StartCapture&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoResize</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoMove</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoTitleBar</span><span class="p">))</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerText</span><span class="p">(</span><span class="s">&quot;You have an ongoing capture.&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerText</span><span class="p">(</span><span class="s">&quot; do you want to start another one?&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerText</span><span class="p">(</span><span class="s">&quot;(the current one will be reset)&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosY</span><span class="p">(</span><span class="mi">350</span><span class="p">);</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerButton</span><span class="p">(</span><span class="s">&quot;Yes&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">doneCapturing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">showStart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">captureThread</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">captured</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">capturedLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">doneCapturing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">captureThread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="p">(</span><span class="n">Capture</span><span class="o">::</span><span class="n">capturePackets</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosY</span><span class="p">(</span><span class="mi">430</span><span class="p">);</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">centerButton</span><span class="p">(</span><span class="s">&quot;No&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">showStart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">EndPopup</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">GUI</span><span class="o">::</span><span class="n">popFont</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
<span class="w">	</span><span class="n">init</span><span class="p">();</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAdapter</span><span class="p">();</span>

<span class="w">	</span><span class="n">Data</span><span class="o">::</span><span class="n">chosenAdapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">adapter</span><span class="p">;</span>

<span class="w">	</span><span class="n">Data</span><span class="o">::</span><span class="n">captureThread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="p">(</span><span class="n">Capture</span><span class="o">::</span><span class="n">capturePackets</span><span class="p">);</span>

<span class="w">	</span><span class="n">remove</span><span class="p">(</span><span class="s">&quot;captures/output.pcap&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="n">remove</span><span class="p">(</span><span class="s">&quot;captures/output.txt&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="n">remove</span><span class="p">(</span><span class="s">&quot;imgui.ini&quot;</span><span class="p">);</span>

<span class="w">	</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span>
<span class="w">	</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">columns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>

<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">glfwWindowShouldClose</span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">window</span><span class="p">))</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="c1">// Poll and handle events</span>
<span class="w">		</span><span class="n">glfwPollEvents</span><span class="p">();</span>

<span class="w">		</span><span class="c1">// Start the Dear ImGui frame</span>
<span class="w">		</span><span class="n">ImGui_ImplOpenGL3_NewFrame</span><span class="p">();</span>
<span class="w">		</span><span class="n">ImGui_ImplGlfw_NewFrame</span><span class="p">();</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">NewFrame</span><span class="p">();</span>

<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">pushFont</span><span class="p">(</span><span class="s">&quot;regular&quot;</span><span class="p">);</span>

<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowPos</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">));</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowSize</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">1280</span><span class="p">,</span><span class="w"> </span><span class="mi">360</span><span class="p">));</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Begin</span><span class="p">(</span><span class="s">&quot;Packet Table Window&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoResize</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoMove</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoCollapse</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoTitleBar</span><span class="p">);</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">BeginMainMenuBar</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">BeginMenu</span><span class="p">(</span><span class="s">&quot;File&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">MenuItem</span><span class="p">(</span><span class="s">&quot;Load&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="c1">// handle load</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">MenuItem</span><span class="p">(</span><span class="s">&quot;Save&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="c1">// handle save</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">				</span><span class="n">ImGui</span><span class="o">::</span><span class="n">EndMenu</span><span class="p">();</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">BeginMenu</span><span class="p">(</span><span class="s">&quot;Capture&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">MenuItem</span><span class="p">(</span><span class="s">&quot;Start&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="n">Data</span><span class="o">::</span><span class="n">showStart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">MenuItem</span><span class="p">(</span><span class="s">&quot;Stop&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="n">Data</span><span class="o">::</span><span class="n">showStop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">				</span><span class="n">ImGui</span><span class="o">::</span><span class="n">EndMenu</span><span class="p">();</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">EndMainMenuBar</span><span class="p">();</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Data</span><span class="o">::</span><span class="n">showStop</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">handleStop</span><span class="p">();</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Data</span><span class="o">::</span><span class="n">showStart</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">handleStart</span><span class="p">();</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">BeginTable</span><span class="p">(</span><span class="s">&quot;Packet Table&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">columns</span><span class="p">))</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetupColumn</span><span class="p">(</span><span class="s">&quot;No.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiTableColumnFlags_WidthFixed</span><span class="p">,</span><span class="w"> </span><span class="mf">80.0f</span><span class="p">);</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetupColumn</span><span class="p">(</span><span class="s">&quot;Time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiTableColumnFlags_WidthFixed</span><span class="p">,</span><span class="w"> </span><span class="mf">90.0f</span><span class="p">);</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetupColumn</span><span class="p">(</span><span class="s">&quot;Source&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiTableColumnFlags_WidthFixed</span><span class="p">,</span><span class="w"> </span><span class="mf">200.0f</span><span class="p">);</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetupColumn</span><span class="p">(</span><span class="s">&quot;Destination&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiTableColumnFlags_WidthFixed</span><span class="p">,</span><span class="w"> </span><span class="mf">200.0f</span><span class="p">);</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetupColumn</span><span class="p">(</span><span class="s">&quot;Protocol&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiTableColumnFlags_WidthFixed</span><span class="p">,</span><span class="w"> </span><span class="mf">100.0f</span><span class="p">);</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetupColumn</span><span class="p">(</span><span class="s">&quot;Length&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiTableColumnFlags_WidthFixed</span><span class="p">,</span><span class="w"> </span><span class="mf">50.0f</span><span class="p">);</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableSetupColumn</span><span class="p">(</span><span class="s">&quot;Info&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiTableColumnFlags_WidthFixed</span><span class="p">,</span><span class="w"> </span><span class="mf">560.0f</span><span class="p">);</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableHeadersRow</span><span class="p">();</span>

<span class="w">			</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">capturedLength</span><span class="p">;</span><span class="w"> </span><span class="n">row</span><span class="o">++</span><span class="p">)</span>
<span class="w">			</span><span class="p">{</span>
<span class="w">				</span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">guard</span><span class="p">(</span><span class="n">Data</span><span class="o">::</span><span class="n">guard</span><span class="p">);</span>
<span class="w">				</span><span class="n">ImGui</span><span class="o">::</span><span class="n">TableNextRow</span><span class="p">();</span>

<span class="w">				</span><span class="k">auto</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">captured</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">row</span><span class="p">);</span>

<span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="n">a</span><span class="o">-&gt;</span><span class="n">render</span><span class="p">();</span>
<span class="w">				</span><span class="p">}</span>

<span class="w">			</span><span class="p">}</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">EndTable</span><span class="p">();</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">End</span><span class="p">();</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowPos</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">380</span><span class="p">));</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowSize</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span><span class="w"> </span><span class="mi">340</span><span class="p">));</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Begin</span><span class="p">(</span><span class="s">&quot;Expanded Packet&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoResize</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoMove</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoCollapse</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoTitleBar</span><span class="p">);</span>

<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">captured</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">renderExpanded</span><span class="p">();</span>

<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">End</span><span class="p">();</span>

<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowPos</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span><span class="w"> </span><span class="mi">380</span><span class="p">));</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetNextWindowSize</span><span class="p">(</span><span class="n">ImVec2</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span><span class="w"> </span><span class="mi">340</span><span class="p">));</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Begin</span><span class="p">(</span><span class="s">&quot;Packet Data View&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoResize</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoMove</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoCollapse</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImGuiWindowFlags_NoTitleBar</span><span class="p">);</span>

<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">;</span>

<span class="w">			</span><span class="n">GUI</span><span class="o">::</span><span class="n">pushFont</span><span class="p">(</span><span class="s">&quot;hexView&quot;</span><span class="p">);</span>

<span class="w">			</span><span class="k">auto</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">captured</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">Data</span><span class="o">::</span><span class="n">selected</span><span class="p">);</span>

<span class="w">			</span><span class="kt">int</span><span class="w"> </span><span class="n">inc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">			</span><span class="k">auto</span><span class="w"> </span><span class="n">hexData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">getTexts</span><span class="p">().</span><span class="n">at</span><span class="p">(</span><span class="s">&quot;hexData&quot;</span><span class="p">);</span>

<span class="w">			</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">hexData</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hexData</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">					</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setfill</span><span class="p">(</span><span class="sc">&#39;0&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">inc</span><span class="p">;</span>
<span class="w">					</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosX</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">					</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">str</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">					</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">byte</span><span class="p">;</span>
<span class="w">					</span><span class="n">inc</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">				</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="n">str</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">byte</span><span class="p">;</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">SetCursorPosX</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setfill</span><span class="p">(</span><span class="sc">&#39;0&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">inc</span><span class="p">;</span>
<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">((</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">str</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">			</span>
<span class="w">			</span><span class="n">GUI</span><span class="o">::</span><span class="n">popFont</span><span class="p">();</span>

<span class="w">			</span><span class="n">ImGui</span><span class="o">::</span><span class="n">End</span><span class="p">();</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="c1">// Rendering</span>
<span class="w">		</span><span class="n">GUI</span><span class="o">::</span><span class="n">popFont</span><span class="p">();</span>
<span class="w">		</span><span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span><span class="p">);</span>
<span class="w">		</span><span class="n">ImGui</span><span class="o">::</span><span class="n">Render</span><span class="p">();</span>
<span class="w">		</span><span class="n">ImGui_ImplOpenGL3_RenderDrawData</span><span class="p">(</span><span class="n">ImGui</span><span class="o">::</span><span class="n">GetDrawData</span><span class="p">());</span>
<span class="w">		</span><span class="n">glfwSwapBuffers</span><span class="p">(</span><span class="n">GUI</span><span class="o">::</span><span class="n">window</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">Data</span><span class="o">::</span><span class="n">doneCapturing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">	</span><span class="n">Data</span><span class="o">::</span><span class="n">captureThread</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>

<span class="w">	</span><span class="n">pcap_close</span><span class="p">(</span><span class="n">adapter</span><span class="p">);</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#ifdef NDEBUG</span>

<span class="c1">// because nothing can ever be simple in this goddamn operating system</span>
<span class="kt">int</span><span class="w"> </span><span class="n">WINAPI</span><span class="w"> </span><span class="nf">WinMain</span><span class="p">(</span><span class="n">HINSTANCE</span><span class="w"> </span><span class="n">hInstance</span><span class="p">,</span><span class="w"> </span><span class="n">HINSTANCE</span><span class="w"> </span><span class="n">hPrevInstance</span><span class="p">,</span><span class="w"> </span><span class="n">LPSTR</span><span class="w"> </span><span class="n">lpCmdLine</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nCmdShow</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">;</span>
<span class="w">	</span><span class="n">LPWSTR</span><span class="o">*</span><span class="w"> </span><span class="n">argvW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CommandLineToArgvW</span><span class="p">(</span><span class="n">GetCommandLineW</span><span class="p">(),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">argc</span><span class="p">);</span>
<span class="w">	</span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="p">[</span><span class="n">argc</span><span class="p">];</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">argc</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">wlen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lstrlenW</span><span class="p">(</span><span class="n">argvW</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WideCharToMultiByte</span><span class="p">(</span><span class="n">CP_ACP</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">argvW</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">wlen</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">		</span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">char</span><span class="p">[</span><span class="n">size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="w">		</span><span class="n">WideCharToMultiByte</span><span class="p">(</span><span class="n">CP_ACP</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">argvW</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">wlen</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">LocalFree</span><span class="p">(</span><span class="n">argvW</span><span class="p">);</span>

<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">main</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">argc</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">argv</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#endif</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Capture.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tchar.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../Win/SDK.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Packets/Packets.h&quot;</span>

<span class="n">pcap_if_t</span><span class="o">*</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">m_alldevs</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">m_devs</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">m_devNames</span><span class="p">;</span>
<span class="n">pcap_dumper_t</span><span class="o">*</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">m_dumpfile</span><span class="p">;</span>

<span class="kt">bool</span><span class="w"> </span><span class="nf">Capture::LoadNpcapDlls</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">_TCHAR</span><span class="w"> </span><span class="n">npcap_dir</span><span class="p">[</span><span class="mi">512</span><span class="p">];</span>
<span class="w">	</span><span class="n">UINT</span><span class="w"> </span><span class="n">len</span><span class="p">;</span>
<span class="w">	</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetSystemDirectory</span><span class="p">(</span><span class="n">npcap_dir</span><span class="p">,</span><span class="w"> </span><span class="mi">480</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">GetLastError</span><span class="p">();</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Error in GetSystemDirectory: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">_tcscat_s</span><span class="p">(</span><span class="n">npcap_dir</span><span class="p">,</span><span class="w"> </span><span class="mi">512</span><span class="p">,</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">Npcap&quot;</span><span class="p">));</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SetDllDirectory</span><span class="p">(</span><span class="n">npcap_dir</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">GetLastError</span><span class="p">();</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Error in SetDllDirectory: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Capture::init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// load the stupid dlls</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">LoadNpcapDlls</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t load Npcap&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="n">errbuf</span><span class="p">[</span><span class="n">PCAP_ERRBUF_SIZE</span><span class="p">];</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="c1">// get the stupid devices and put  them into the stupid variable</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pcap_findalldevs</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_alldevs</span><span class="p">,</span><span class="w"> </span><span class="n">errbuf</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">errbuf</span><span class="p">;</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Error in pcap_findalldevs: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">m_devs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">pcap_if_t</span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_alldevs</span><span class="p">;</span><span class="w"> </span><span class="n">d</span><span class="p">;</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">,</span><span class="w"> </span><span class="n">m_devs</span><span class="o">++</span><span class="p">);</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_devs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;No interfaces found! Make sure Npcap is installed.&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">WSADATA</span><span class="w"> </span><span class="n">wsaData</span><span class="p">;</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">WSAStartup</span><span class="p">(</span><span class="n">MAKEWORD</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">wsaData</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Error initializing Winsock&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Capture::release</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">pcap_freealldevs</span><span class="p">(</span><span class="n">m_alldevs</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_dumpfile</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">pcap_dump_close</span><span class="p">(</span><span class="n">m_dumpfile</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">WSACleanup</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">pcap_if_t</span><span class="o">*</span><span class="w"> </span><span class="nf">Capture::getDev</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_devs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">index</span><span class="p">;</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;device index &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; does not exist :(&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">pcap_if_t</span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_alldevs</span><span class="p">;</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">index</span><span class="o">--</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">);</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">d</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">getDeviceNames</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">verbose</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_devNames</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">m_devNames</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_alldevs</span><span class="p">;</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_devs</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="o">-&gt;</span><span class="n">description</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">d</span><span class="o">-&gt;</span><span class="n">description</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;unknown interface&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">d</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">m_devNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="w">		</span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">m_devNames</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">pcap_t</span><span class="o">*</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">createAdapter</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">devIndex</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">promiscuous</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">dev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getDev</span><span class="p">(</span><span class="n">devIndex</span><span class="p">);</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">prom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">promiscuous</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">prom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="n">errbuf</span><span class="p">[</span><span class="n">PCAP_ERRBUF_SIZE</span><span class="p">];</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">adhandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcap_open_live</span><span class="p">(</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="mi">65536</span><span class="p">,</span><span class="w"> </span><span class="n">prom</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">errbuf</span><span class="p">);</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">adhandle</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Unable to open the adapter. &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; is not supported by Npcap&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;adapter handle is nullptr. &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">adhandle</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">dump</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">pcap_dump</span><span class="p">((</span><span class="n">u_char</span><span class="o">*</span><span class="p">)</span><span class="n">m_dumpfile</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">pkt</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">pcap_t</span><span class="o">*</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">load</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="n">errbuf</span><span class="p">[</span><span class="n">PCAP_ERRBUF_SIZE</span><span class="p">];</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcap_open_offline</span><span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="n">errbuf</span><span class="p">);</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handle</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Unable to open the file.&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">capturePackets</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">chosenAdapter</span><span class="p">;</span>
<span class="w">	</span><span class="k">struct</span><span class="w"> </span><span class="nc">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">;</span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>

<span class="cp">#ifdef _DEBUG</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Capture</span><span class="o">::</span><span class="n">getDev</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="k">struct</span><span class="w"> </span><span class="nc">bpf_program</span><span class="w"> </span><span class="n">fcode</span><span class="p">;</span>

<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">netmask</span><span class="p">;</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="o">-&gt;</span><span class="n">addresses</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="w">		</span><span class="cm">/* Retrieve the mask of the first address of the interface */</span>
<span class="w">		</span><span class="n">netmask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="k">struct</span><span class="w"> </span><span class="nc">sockaddr_in</span><span class="o">*</span><span class="p">)(</span><span class="n">d</span><span class="o">-&gt;</span><span class="n">addresses</span><span class="o">-&gt;</span><span class="n">netmask</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">S_un</span><span class="p">.</span><span class="n">S_addr</span><span class="p">;</span>
<span class="w">	</span><span class="k">else</span>
<span class="w">		</span><span class="cm">/* If the interface is without an address</span>
<span class="cm">		 * we suppose to be in a C class network */</span>
<span class="w">		</span><span class="n">netmask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xffffff</span><span class="p">;</span>

<span class="w">	</span><span class="c1">//compile the filter</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pcap_compile</span><span class="p">(</span><span class="n">adapter</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">fcode</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">netmask</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span>
<span class="w">			</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Unable to compile the packet filter. Check the syntax.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">-1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="c1">//set the filter</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pcap_setfilter</span><span class="p">(</span><span class="n">adapter</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">fcode</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Error setting the filter.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">-1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="cp">#endif</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">pcap_next_ex</span><span class="p">(</span><span class="n">adapter</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pkt_data</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>

<span class="w">	</span><span class="n">Data</span><span class="o">::</span><span class="n">epochStart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">header</span><span class="o">-&gt;</span><span class="n">ts</span><span class="p">.</span><span class="n">tv_sec</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">header</span><span class="o">-&gt;</span><span class="n">ts</span><span class="p">.</span><span class="n">tv_usec</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1000000.0</span><span class="p">;</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fromRaw</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="o">++</span><span class="p">);</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">guard</span><span class="p">(</span><span class="n">Data</span><span class="o">::</span><span class="n">guard</span><span class="p">);</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">captured</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">		</span><span class="n">Data</span><span class="o">::</span><span class="n">capturedLength</span><span class="o">++</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; - &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcap_next_ex</span><span class="p">(</span><span class="n">adapter</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pkt_data</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">Data</span><span class="o">::</span><span class="n">doneCapturing</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">continue</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fromRaw</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="o">++</span><span class="p">);</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">guard</span><span class="p">(</span><span class="n">Data</span><span class="o">::</span><span class="n">guard</span><span class="p">);</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">captured</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">			</span><span class="n">Data</span><span class="o">::</span><span class="n">capturedLength</span><span class="o">++</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; - &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../Base/Base.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Capture</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="c1">// club pinguin is kil</span>
<span class="w">	</span><span class="c1">// no</span>
<span class="w">	</span><span class="n">Capture</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">release</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">pcap_if_t</span><span class="o">*</span><span class="w"> </span><span class="nf">getDev</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getDeviceNames</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">pcap_t</span><span class="o">*</span><span class="w"> </span><span class="nf">createAdapter</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">devIndex</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">promiscuous</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">capturePackets</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">dump</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">pcap_t</span><span class="o">*</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">pcap_if_t</span><span class="o">*</span><span class="w"> </span><span class="n">m_alldevs</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_devs</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_devNames</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">pcap_dumper_t</span><span class="o">*</span><span class="w"> </span><span class="n">m_dumpfile</span><span class="p">;</span>

<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">LoadNpcapDlls</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Capture.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Packets/Packets.h&quot;</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Packets.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ws2def.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../Base/Logger.h&quot;</span>

<span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ETHERTYPE_IPV4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0800</span><span class="p">;</span>
<span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ETHERTYPE_ARP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0806</span><span class="p">;</span>
<span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ETHERTYPE_IPV6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x86DD</span><span class="p">;</span>

<span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">IPV4_PROTO_POS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">23</span><span class="p">;</span>
<span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">IPV6_PROTO_POS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>

<span class="n">IPV4_PKT</span><span class="w"> </span><span class="nf">fromIPV4</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">IPV4_PROTO_POS</span><span class="p">];</span>

<span class="w">	</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_TCP</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TCP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_UDP</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UDP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_IGMP</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IGMP</span><span class="o">&lt;</span><span class="n">IPV4</span><span class="o">&gt;</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_ICMP</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ICMP</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">default</span><span class="o">:</span>
<span class="cp">#ifdef _DEBUG</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;unknown v4 protocol: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">proto</span><span class="p">;</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="cp">#endif</span>
<span class="w">		</span><span class="k">break</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;unknown v4 protocol: &quot;</span><span class="p">);</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;bad proto &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IPV4</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">IPV6_PKT</span><span class="w"> </span><span class="nf">fromIPV6</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">proto_pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IPV6_PROTO_POS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">proto_pos</span><span class="p">];</span>

<span class="w">	</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_HOPOPTS</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">fromIPV6</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="mi">54</span><span class="p">);</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_TCP</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TCP</span><span class="o">&lt;</span><span class="n">IPV6</span><span class="o">&gt;</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_UDP</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UDP</span><span class="o">&lt;</span><span class="n">IPV6</span><span class="o">&gt;</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_ICMPV6</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ICMPV6</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">default</span><span class="o">:</span>
<span class="cp">#ifdef _DEBUG</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;unknown v6 protocol: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">proto</span><span class="p">;</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="cp">#endif</span>
<span class="w">		</span><span class="k">break</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IPV6</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">PKT</span><span class="w"> </span><span class="nf">fromRaw</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">u_char</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span>
<span class="w">	</span><span class="n">u_char</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="mi">13</span><span class="p">];</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">t1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">t2</span><span class="p">;</span>

<span class="w">	</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">ETHERTYPE_IPV4</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">fromIPV4</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">ETHERTYPE_IPV6</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">fromIPV6</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">ETHERTYPE_ARP</span><span class="p">:</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ARP</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">default</span><span class="o">:</span>
<span class="cp">#ifdef _DEBUG</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;unknown packet type: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="cp">#endif</span>
<span class="w">		</span><span class="k">break</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Packet</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Types/Types.h&quot;</span>

<span class="n">PKT</span><span class="w"> </span><span class="nf">fromRaw</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../Eth/Packet.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../IP/IP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;uchar.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../../../GUI/Renderer.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;type_traits&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ICMP</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IPV4</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_ICMPtype</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_code</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_ICMPChecksum</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_indentifierBE</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_indentifierLE</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_seqNumberBE</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_seqNumberLE</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">m_ROHLength</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_typeDesc</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_restOfHeader</span><span class="p">;</span>

<span class="w">	</span><span class="n">ICMP</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IPV4</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_ICMPtype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>
<span class="w">		</span><span class="n">m_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>
<span class="w">		</span><span class="n">m_ICMPChecksum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>
<span class="w">		</span><span class="n">m_indentifierBE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>
<span class="w">		</span><span class="n">m_indentifierLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">htons</span><span class="p">(</span><span class="n">m_indentifierBE</span><span class="p">);</span>
<span class="w">		</span><span class="n">m_seqNumberBE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>
<span class="w">		</span><span class="n">m_seqNumberLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">htons</span><span class="p">(</span><span class="n">m_seqNumberBE</span><span class="p">);</span>
<span class="w">		</span><span class="n">m_ROHLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="p">;</span>
<span class="w">		</span><span class="n">m_restOfHeader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">m_ROHLength</span><span class="p">);</span>

<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ICMP (&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">		</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">m_ICMPtype</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Echo (ping) reply&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="mi">8</span><span class="p">:</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Echo (ping) request&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">default</span><span class="o">:</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Unknown code &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_ICMPtype</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">m_typeDesc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>

<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; len = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_ROHLength</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; TTL = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">IPV4</span><span class="o">::</span><span class="n">m_ttl</span><span class="p">;</span>

<span class="w">		</span><span class="n">m_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;ICMP Title&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">});</span>
<span class="w">		</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;ICMP Data&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ICMPV4 packet at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; of type &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_ICMPtype</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; of code &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_code</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; (with checksum &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_ICMPChecksum</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; and rest of header is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_restOfHeader</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">json</span><span class="w"> </span><span class="n">jsonify</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonify</span><span class="p">();</span>

<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;ICMP&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;start&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Type&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_ICMPtype</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Code&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_code</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;ICMP Checksum&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_ICMPChecksum</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Indentifier BE&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_indentifierBE</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Indentifier LE&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_indentifierLE</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Sequence Number BE&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_seqNumberBE</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Sequence Number LE&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_seqNumberLE</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;ROH Length&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_ROHLength</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;The Rest of the Header&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_restOfHeader</span><span class="p">;</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">render</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">render</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">renderExpanded</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">renderExpanded</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getTexts</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">IPV4</span><span class="o">::</span><span class="n">getTexts</span><span class="p">();</span>

<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;ICMPType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Type: {} ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_ICMPtype</span><span class="p">,</span><span class="w"> </span><span class="n">m_typeDesc</span><span class="p">);</span>

<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;ICMPCode&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Code: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_code</span><span class="p">);</span>

<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;ICMPChecksum&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Checksum: 0x{:x}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_ICMPChecksum</span><span class="p">);</span>

<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;IDBE&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Identifier (BE): {} (0x{:x})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_indentifierBE</span><span class="p">,</span><span class="w"> </span><span class="n">m_indentifierBE</span><span class="p">);</span>

<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;IDLE&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Identifier (LE): {} (0x{:x})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_indentifierLE</span><span class="p">,</span><span class="w"> </span><span class="n">m_indentifierLE</span><span class="p">);</span>

<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;SNBE&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Sequence Number (BE): {} (0x{:x})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_seqNumberBE</span><span class="p">,</span><span class="w"> </span><span class="n">m_seqNumberBE</span><span class="p">);</span>

<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;SNLE&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Sequence Number (LE): {} (0x{:x})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_seqNumberLE</span><span class="p">,</span><span class="w"> </span><span class="n">m_seqNumberLE</span><span class="p">);</span>

<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;ICMPDataHeader&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;   Data ({} bytes)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_ROHLength</span><span class="p">);</span>

<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;ICMPData&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t</span><span class="s">Data: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_restOfHeader</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../Eth/Packet.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../IP/IP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;uchar.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../../../GUI/Renderer.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;type_traits&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ICMPV6</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IPV6</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_ICMPV6type</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_code</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_ICMPV6Checksum</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">m_messageLength</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_messageBody</span><span class="p">;</span>

<span class="w">	</span><span class="n">ICMPV6</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IPV6</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_ICMPV6type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>
<span class="w">		</span><span class="n">m_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>
<span class="w">		</span><span class="n">m_ICMPV6Checksum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>
<span class="w">		</span><span class="n">m_messageLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IPV6</span><span class="o">::</span><span class="n">m_payloadLength</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">		</span><span class="n">m_messageBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parse</span><span class="p">(</span><span class="n">m_messageLength</span><span class="p">);</span>

<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ICMPV6&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">		</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">m_ICMPV6type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="mi">128</span><span class="p">:</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Echo (ping) reply &quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="mi">129</span><span class="p">:</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Echo (ping) request &quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">default</span><span class="o">:</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Unknown code &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_ICMPV6type</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; len = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_messageLength</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; hop limit = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">IPV6</span><span class="o">::</span><span class="n">m_hopLimit</span><span class="p">;</span>

<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ICMPV4 packet at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; of type &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_ICMPV6type</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; of code &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_code</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; (with checksum &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_ICMPV6Checksum</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">json</span><span class="w"> </span><span class="n">jsonify</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IPV6</span><span class="o">::</span><span class="n">jsonify</span><span class="p">();</span>

<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;ICMP&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;start&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Type&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_ICMPV6type</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Code&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_code</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;ICMP Checksum&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_ICMPV6Checksum</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;length of message&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_messageLength</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;message&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_messageBody</span><span class="p">;</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">render</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">render</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../IP/IP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../../../GUI/Renderer.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>


<span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x16</span><span class="p">;</span>
<span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x17</span><span class="p">;</span>
<span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x11</span><span class="p">;</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">IPVersion</span><span class="o">&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IGMP</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IPVersion</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="n">m_groupType</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_maxResp</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_checksum</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_multicastAddr</span><span class="p">;</span>

<span class="w">	</span><span class="n">IGMP</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IPVersion</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_groupType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>
<span class="w">		</span><span class="n">m_maxResp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>
<span class="w">		</span><span class="n">m_checksum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>
<span class="w">		</span><span class="n">m_multicastAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseIPV4</span><span class="p">();</span>

<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;IGMP (&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">;</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">m_groupType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="no">report</span><span class="p">):</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Membership Report Group &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_multicastAddr</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="no">leave</span><span class="p">):</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Leave Group &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_multicastAddr</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="no">query</span><span class="p">):</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Membership Query, general&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">default</span><span class="o">:</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IGMP Packet&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>

<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;IGMP Title&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IGMP of group type &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_groupType</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; max resp time is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_maxResp</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; for multicast addr: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_multicastAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">json</span><span class="w"> </span><span class="n">jsonify</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">jsonify</span><span class="p">();</span>

<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;IGMP&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;start&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Group Type&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_groupType</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Max Response Time&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_maxResp</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;IGMP Checksum&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_checksum</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Multicast Address&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_multicastAddr</span><span class="p">;</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">render</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">render</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">renderExpanded</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">renderExpanded</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getTexts</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">IPVersion</span><span class="o">::</span><span class="n">getTexts</span><span class="p">();</span>

<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">			</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">m_groupType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="no">report</span><span class="p">):</span>
<span class="w">				</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;groupType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Membership Report&quot;</span><span class="p">;</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="no">leave</span><span class="p">):</span>
<span class="w">				</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;groupType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Leave Group&quot;</span><span class="p">;</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="no">query</span><span class="p">):</span>
<span class="w">				</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;groupType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Membership Query&quot;</span><span class="p">;</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="k">default</span><span class="o">:</span>
<span class="w">				</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;groupType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">;</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="p">}</span>

<span class="w">			</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;IGMPType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Type: {} (0x{:x})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;groupType&quot;</span><span class="p">],</span><span class="w"> </span><span class="n">m_groupType</span><span class="p">);</span>

<span class="w">			</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;respTime&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Max Resp Time: {} sec (0x{:x})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_maxResp</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">m_maxResp</span><span class="p">);</span>

<span class="w">			</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;IGMPChecksum&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Checksum: 0x{:x}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_checksum</span><span class="p">);</span>

<span class="w">			</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;multicastAddr&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Multicast Address: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_multicastAddr</span><span class="p">);</span>

<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPOptions/TCPOptions.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../Eth/Packet.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../IP/IP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../src/Networks/capture.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../src/Win/SDK.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../../../GUI/Renderer.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">IPVersion</span><span class="o">&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IPVersion</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">static_assert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">is_base_of_v</span><span class="o">&lt;</span><span class="n">Packet</span><span class="p">,</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">		</span><span class="s">&quot;IPVersion must inherit from Packet&quot;</span><span class="p">);</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_srcPort</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_destPort</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_seqNum</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_ackNum</span><span class="p">;</span>
<span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="n">m_TCPLength</span><span class="p">;</span>
<span class="w">	</span><span class="kt">short</span><span class="w"> </span><span class="n">m_TCPflags</span><span class="p">;</span>
<span class="w">	</span><span class="kt">short</span><span class="w"> </span><span class="n">m_window</span><span class="p">;</span>
<span class="w">	</span><span class="kt">short</span><span class="w"> </span><span class="n">m_TCPchecksum</span><span class="p">;</span>
<span class="w">	</span><span class="kt">short</span><span class="w"> </span><span class="n">m_urgentPtr</span><span class="p">;</span>

<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_optionCount</span><span class="p">;</span>
<span class="w">	</span><span class="n">TCPOption</span><span class="o">**</span><span class="w"> </span><span class="n">m_options</span><span class="p">;</span>

<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_payload</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_process</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_TCPTitle</span><span class="p">;</span>

<span class="w">	</span><span class="n">TCP</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IPVersion</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_srcPort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_destPort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_seqNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseInt</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_ackNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseInt</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_TCPLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pkt_data</span><span class="p">[</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>

<span class="w">		</span><span class="n">m_TCPflags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pkt_data</span><span class="p">[</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0F</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>

<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="w">		</span><span class="n">m_window</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_TCPchecksum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_urgentPtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">		</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ETHLEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">14</span><span class="p">;</span>
<span class="w">		</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">NOP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">		</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">MSS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">		</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">WSCALE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">		</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">SACKPERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">		</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">SACK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">		</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">TIMESTAMPS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>

<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_TCPLength</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ETHLEN</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">m_headerLength</span><span class="p">;</span>
<span class="w">		</span><span class="n">m_optionCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">TCPOption</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">vec</span><span class="p">;</span>

<span class="w">		</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">total</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">signed</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="n">IPVersion</span><span class="o">::</span><span class="n">pos</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="kt">int</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">Packet</span><span class="o">::</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>
<span class="w">			</span><span class="n">m_optionCount</span><span class="o">++</span><span class="p">;</span>

<span class="w">			</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="no">NOP</span><span class="p">:</span>
<span class="w">				</span><span class="n">vec</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TCPNOP</span><span class="p">());</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="no">MSS</span><span class="p">:</span>
<span class="w">				</span><span class="n">vec</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TCPMSS</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="p">(</span><span class="n">IPVersion</span><span class="o">::</span><span class="n">pos</span><span class="p">)));</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="no">WSCALE</span><span class="p">:</span>
<span class="w">				</span><span class="n">vec</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TCPWScale</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="p">(</span><span class="n">IPVersion</span><span class="o">::</span><span class="n">pos</span><span class="p">)));</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="no">SACKPERM</span><span class="p">:</span>
<span class="w">				</span><span class="n">vec</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TCPSACKPerm</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="p">(</span><span class="n">IPVersion</span><span class="o">::</span><span class="n">pos</span><span class="p">)));</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="no">SACK</span><span class="p">:</span>
<span class="w">				</span><span class="n">vec</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TCPSACK</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="p">(</span><span class="n">IPVersion</span><span class="o">::</span><span class="n">pos</span><span class="p">)));</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="k">default</span><span class="o">:</span>
<span class="cp">#ifdef _DEBUG</span>
<span class="w">				</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">				</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;bad tcp option of code &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; at packet index &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">idx</span><span class="p">;</span>
<span class="w">				</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="w">				</span><span class="c1">// Capture::dump(header, pkt_data);</span>
<span class="w">				</span><span class="n">m_optionCount</span><span class="o">--</span><span class="p">;</span>
<span class="w">				</span><span class="c1">// exit(code);</span>
<span class="cp">#endif</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">m_options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TCPOption</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">[</span><span class="n">vec</span><span class="p">.</span><span class="n">size</span><span class="p">()];</span>

<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">vec</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">m_options</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_len</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">m_payloadLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">pos</span><span class="p">;</span>
<span class="w">			</span><span class="n">m_payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">m_payloadLength</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="c1">//if constexpr (std::is_same_v&lt;IPVersion, IPV4&gt;) {</span>
<span class="w">		</span><span class="c1">//	/*if (IPVersion::m_srcAddr == SDK::ipAddress) {</span>
<span class="w">		</span><span class="c1">//		m_process = SDK::getProcFromPort(m_srcPort);</span>
<span class="w">		</span><span class="c1">//	}</span>
<span class="w">		</span><span class="c1">//	else {</span>
<span class="w">		</span><span class="c1">//		m_process = SDK::getProcFromPort(m_destPort);</span>
<span class="w">		</span><span class="c1">//	}*/</span>
<span class="w">		</span><span class="c1">//	m_process = SDK::getProcFromPort(m_srcPort);</span>
<span class="w">		</span><span class="c1">//	if (m_process.at(0) == &#39;&lt;&#39; &amp;&amp; m_process.at(m_process.size() - 1) == &#39;&gt;&#39;) {</span>
<span class="w">		</span><span class="c1">//		m_process = SDK::getProcFromPort(m_destPort);</span>
<span class="w">		</span><span class="c1">//	}</span>
<span class="w">		</span><span class="c1">//}</span>
<span class="w">		</span><span class="c1">//else if constexpr (std::is_same_v&lt;IPVersion, IPV6&gt;) {</span>
<span class="w">		</span><span class="c1">//	m_process = SDK::getProcFromPort(m_srcPort);</span>
<span class="w">		</span><span class="c1">//	if (m_process.at(0) == &#39;&lt;&#39; &amp;&amp; m_process.at(m_process.size() - 1) == &#39;&gt;&#39;) {</span>
<span class="w">		</span><span class="c1">//		m_process = SDK::getProcFromPort(m_destPort);</span>
<span class="w">		</span><span class="c1">//	}</span>
<span class="w">		</span><span class="c1">//}</span>

<span class="w">		</span><span class="n">m_process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">getProcFromPort</span><span class="p">(</span><span class="n">m_srcPort</span><span class="p">);</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_process</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;&lt;&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_process</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">m_process</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;&gt;&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">m_process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">getProcFromPort</span><span class="p">(</span><span class="n">m_destPort</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;TCP (&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_process</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;) &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_srcPort</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; -&gt; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_destPort</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; payload length = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="p">;</span>
<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>

<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;TCP Title&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">});</span>

<span class="w">		</span><span class="n">m_TCPTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Transmission Control Protocol, Src Port: {}, Dst Port: {}, Seq: {}, Len: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_srcPort</span><span class="p">,</span><span class="w"> </span><span class="n">m_destPort</span><span class="p">,</span><span class="w"> </span><span class="n">m_seqNum</span><span class="p">,</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;TCPV4 Packet at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; from &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">m_srcAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; at port &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_srcPort</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; to &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">m_destAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; at port &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_destPort</span><span class="p">;</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_optionCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; with options : (&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_optionCount</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="k">auto</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_options</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">				</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">o</span><span class="o">-&gt;</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="p">;</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;. Proccess = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_process</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">json</span><span class="w"> </span><span class="n">jsonify</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">jsonify</span><span class="p">();</span>

<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;TCP&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;start&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Source Port&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_srcPort</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Destination Port&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_destPort</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Sequence Number&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_seqNum</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Acknoledgement Number&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_ackNum</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;TCP Header Length&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_TCPLength</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;TCP Flags&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_TCPflags</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Window&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_window</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;TCP Checksum&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_TCPchecksum</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Urgent Pointer&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_urgentPtr</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Number of Options&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_optionCount</span><span class="p">;</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_optionCount</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">auto</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_options</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">o</span><span class="o">-&gt;</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;TCP Options&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Payload Length&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Payload&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_payload</span><span class="p">;</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">render</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">render</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">renderExpanded</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">renderExpanded</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPMSS.h&quot;</span>

<span class="n">TCPMSS</span><span class="o">::</span><span class="n">TCPMSS</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">TCPOption</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">];</span>
<span class="w">	</span><span class="n">m_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">short</span><span class="p">)</span><span class="n">parseLong</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">TCPMSS</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;TCP Option MSS of value&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_value</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPOption.h&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TCPMSS</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">TCPOption</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_len</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_value</span><span class="p">;</span>

<span class="w">	</span><span class="n">TCPMSS</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPNOP.h&quot;</span>

<span class="n">TCPNOP</span><span class="o">::</span><span class="n">TCPNOP</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">TCPOption</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">TCPNOP</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="s">&quot;No Operation&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPOption.h&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TCPNOP</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">TCPOption</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="n">TCPNOP</span><span class="p">();</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPOption.h&quot;</span>

<span class="n">TCPOption</span><span class="o">::</span><span class="n">TCPOption</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">code</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">m_kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">code</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">TCPOption</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Anonymous Option of code &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_kind</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">TCPOption</span><span class="o">::</span><span class="n">parseLong</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">start</span><span class="p">);</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">start</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">start</span><span class="p">)</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">out</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">start</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">out</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;WinSock2.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../Eth/Packet.h&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TCPOption</span><span class="w"> </span><span class="p">{</span>
<span class="k">protected</span><span class="o">:</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">parseLong</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">);</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_kind</span><span class="p">;</span>

<span class="w">	</span><span class="n">TCPOption</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">code</span><span class="p">);</span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPMSS.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPNOP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPSACK.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPSACKPerm.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPOption.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPWScale.h&quot;</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPSACK.h&quot;</span>

<span class="n">TCPSACK</span><span class="o">::</span><span class="n">TCPSACK</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">TCPOption</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">];</span>

<span class="w">	</span><span class="n">m_edges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">m_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>

<span class="w">	</span><span class="n">m_Ledges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="n">m_edges</span><span class="p">];</span>
<span class="w">	</span><span class="n">m_Redges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="n">m_edges</span><span class="p">];</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_edges</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_Ledges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="n">parseLong</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">);</span>
<span class="w">		</span><span class="n">m_Redges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="n">parseLong</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">TCPSACK</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;TCP Option SACK of &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_edges</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; edges (&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_edges</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; from &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_Ledges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; to &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_Redges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPOption.h&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TCPSACK</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">TCPOption</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_len</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_edges</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">m_Redges</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">m_Ledges</span><span class="p">;</span>

<span class="w">	</span><span class="n">TCPSACK</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPSACKPerm.h&quot;</span>

<span class="n">TCPSACKPerm</span><span class="o">::</span><span class="n">TCPSACKPerm</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">TCPOption</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">];</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">TCPSACKPerm</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;TCP Option SACK Permitted of length &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_len</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPOption.h&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TCPSACKPerm</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">TCPOption</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_len</span><span class="p">;</span>

<span class="w">	</span><span class="n">TCPSACKPerm</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPWScale.h&quot;</span>

<span class="n">TCPWScale</span><span class="o">::</span><span class="n">TCPWScale</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">TCPOption</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">];</span>
<span class="w">	</span><span class="n">m_shift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">];</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">TCPWScale</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;TCP Option Window Scale of length &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_len</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; and shift &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_shift</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; (actual &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_shift</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCPOption.h&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TCPWScale</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">TCPOption</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_len</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_shift</span><span class="p">;</span>

<span class="w">	</span><span class="n">TCPWScale</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../Eth/Packet.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../IP/IP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../src/Win/SDK.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../../../GUI/Renderer.h&quot;</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">IPVersion</span><span class="o">&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IPVersion</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">static_assert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">is_base_of_v</span><span class="o">&lt;</span><span class="n">Packet</span><span class="p">,</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">		</span><span class="s">&quot;IPVersion must inherit from Packet&quot;</span><span class="p">);</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_srcPort</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_destPort</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_length</span><span class="p">;</span>
<span class="w">	</span><span class="kt">short</span><span class="w"> </span><span class="n">m_UDPChecksum</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_payload</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_process</span><span class="p">;</span>

<span class="w">	</span><span class="n">UDP</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IPVersion</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_srcPort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_destPort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_UDPChecksum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_payloadLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>

<span class="w">		</span><span class="n">m_payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">m_payloadLength</span><span class="p">);</span>

<span class="w">		</span><span class="cm">/*if constexpr (std::is_same_v&lt;IPVersion, IPV4&gt;) {</span>
<span class="cm">			if (IPVersion::m_srcAddr == SDK::ipAddress) {</span>
<span class="cm">				m_process = SDK::getProcFromPort(m_srcPort);</span>
<span class="cm">			}</span>
<span class="cm">			else {</span>
<span class="cm">				m_process = SDK::getProcFromPort(m_destPort);</span>
<span class="cm">			}</span>
<span class="cm">		}</span>
<span class="cm">		else if constexpr (std::is_same_v&lt;IPVersion, IPV6&gt;) {</span>
<span class="cm">			m_process = SDK::getProcFromPort(m_srcPort);</span>
<span class="cm">			if (m_process.at(0) == &#39;&lt;&#39; &amp;&amp; m_process.at(m_process.size() - 1) == &#39;&gt;&#39;) {</span>
<span class="cm">				m_process = SDK::getProcFromPort(m_destPort);</span>
<span class="cm">			}</span>
<span class="cm">		}*/</span>

<span class="w">		</span><span class="n">m_process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">getProcFromPort</span><span class="p">(</span><span class="n">m_srcPort</span><span class="p">);</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_process</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;&lt;&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_process</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">m_process</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;&gt;&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">m_process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">getProcFromPort</span><span class="p">(</span><span class="n">m_destPort</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;UDP (&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_process</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;) &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_srcPort</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; -&gt; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_destPort</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; payload length = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="p">;</span>
<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;UDPV4 Packet at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; from &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">m_srcAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; at port &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_srcPort</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; to &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">m_destAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; at port &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_destPort</span><span class="p">;</span>

<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;. Proccess = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_process</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">json</span><span class="w"> </span><span class="n">jsonify</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IPVersion</span><span class="o">::</span><span class="n">jsonify</span><span class="p">();</span>

<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;UDP&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;start&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Source Port&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_srcPort</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Destination Port&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_destPort</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;UDP Length&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_length</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;UDP Checksum&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_UDPChecksum</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Payload Length&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="p">;</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Payload&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_payload</span><span class="p">;</span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">render</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">render</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;ARP.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../../GUI/Renderer.h&quot;</span>

<span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ETHERTYPE_IPV4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0800</span><span class="p">;</span>
<span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ETHERTYPE_IPV6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x86DD</span><span class="p">;</span>

<span class="n">ARP</span><span class="o">::</span><span class="n">ARP</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Packet</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_hardType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_protoType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_hardSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>

<span class="w">	</span><span class="n">m_protoSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>

<span class="w">	</span><span class="n">m_opcode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_sendMAC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseMAC</span><span class="p">(</span><span class="n">m_hardSize</span><span class="p">);</span>

<span class="w">	</span><span class="n">m_sendAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseIPV4</span><span class="p">(</span><span class="n">m_protoSize</span><span class="p">);</span>

<span class="w">	</span><span class="n">m_targetMAC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseMAC</span><span class="p">(</span><span class="n">m_hardSize</span><span class="p">);</span>

<span class="w">	</span><span class="n">m_targetAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseIPV4</span><span class="p">(</span><span class="n">m_protoSize</span><span class="p">);</span>

<span class="w">	</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ARP&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_opcode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;who is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_targetAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;? Tell &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_sendAddr</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_opcode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_sendAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; is at physical address &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_sendMAC</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;unknown opcode &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_opcode</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="n">m_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;ARP Title&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">});</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">ARP</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ARP Packet at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">];</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_opcode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; who tf is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_targetAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;? Tell &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_sendAddr</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_opcode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_sendAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; is at physical address &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_sendMAC</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; unknown opcode &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_opcode</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">json</span><span class="w"> </span><span class="n">ARP</span><span class="o">::</span><span class="n">jsonify</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">jsonify</span><span class="p">();</span>

<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;ARP&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;start&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;hardware type&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_hardType</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;protocol type&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_protoType</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;hardware size&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_hardSize</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;protocol size&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_protoSize</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;operation code&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_opcode</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;sender MAC Address&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_sendMAC</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;sender IP Address&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_sendAddr</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;target MAC Address&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_targetMAC</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;target IP Address&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_targetAddr</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ARP</span><span class="o">::</span><span class="n">getTexts</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_texts</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">getTexts</span><span class="p">();</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_opcode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;opcode&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;request&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_opcode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;opcode&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;reply&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;opcode&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;unknown&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;arpTitle&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Address Resolution Protocol ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;opcode&quot;</span><span class="p">]);</span>

<span class="w">		</span><span class="c1">// DO NOT LEAVE THIS IN YOU SILLY GOOSE</span>
<span class="w">		</span><span class="c1">// todo: actually figure out the type of the hardware</span>
<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;hardType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Ethernet ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">m_hardType</span><span class="p">));</span>

<span class="w">		</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">m_protoType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="no">ETHERTYPE_IPV4</span><span class="p">):</span>
<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;protoType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;IPV4 (0x0800)&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="no">ETHERTYPE_IPV6</span><span class="p">):</span>
<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;protoType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;IPV6 (0x86DD)&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">default</span><span class="o">:</span>
<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;protoType&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;code&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;{} ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;opcode&quot;</span><span class="p">],</span><span class="w"> </span><span class="n">m_opcode</span><span class="p">);</span>

<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">m_texts</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Packet.h&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ARP</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Packet</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_hardType</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_protoType</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_hardSize</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_protoSize</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_opcode</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_sendMAC</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_sendAddr</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_targetMAC</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_targetAddr</span><span class="p">;</span>

<span class="w">	</span><span class="n">ARP</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">	</span><span class="n">json</span><span class="w"> </span><span class="nf">jsonify</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">render</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="nf">renderExpanded</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">renderExpanded</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getTexts</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;ARP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Packet.h&quot;</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Packet.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;json.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;type_traits&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ctime&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;WinSock2.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../../Base/Base.h&quot;</span>

<span class="n">Packet</span><span class="o">::</span><span class="n">Packet</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">m_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idx</span><span class="p">;</span>
<span class="w">	</span><span class="n">m_idxStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="n">m_pktData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">;</span>
<span class="w">	</span><span class="n">m_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">header</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">;</span>
<span class="w">	</span><span class="n">m_epoch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="n">header</span><span class="o">-&gt;</span><span class="n">ts</span><span class="p">.</span><span class="n">tv_sec</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">header</span><span class="o">-&gt;</span><span class="n">ts</span><span class="p">.</span><span class="n">tv_usec</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1000000.0</span><span class="p">);</span>

<span class="w">	</span><span class="n">m_epoch</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">epochStart</span><span class="p">;</span>

<span class="w">	</span><span class="n">m_phyDst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseMAC</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_phySrc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseMAC</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;base packet&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;Packet Title&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">});</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Base Packet at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; of len &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_len</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; type: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_type</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; from &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_phySrc</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; to &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_phyDst</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">json</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">jsonify</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">json</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="p">{</span><span class="s">&quot;header&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;start&quot;</span><span class="p">},</span>
<span class="w">		</span><span class="p">{</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">]},</span>
<span class="w">		</span><span class="p">{</span><span class="s">&quot;epoch&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_epoch</span><span class="p">},</span>
<span class="w">		</span><span class="p">{</span><span class="s">&quot;len&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_len</span><span class="p">},</span>
<span class="w">		</span><span class="p">{</span><span class="s">&quot;base packet&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;start&quot;</span><span class="p">},</span>
<span class="w">		</span><span class="p">{</span><span class="s">&quot;physical destination&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_phyDst</span><span class="p">},</span>
<span class="w">		</span><span class="p">{</span><span class="s">&quot;physical source&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_phySrc</span><span class="p">},</span>
<span class="w">		</span><span class="p">{</span><span class="s">&quot;packet type&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_type</span><span class="p">},</span>
<span class="w">	</span><span class="p">};</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">padDate</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">length</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseMAC</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">mac</span><span class="p">;</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="n">pos</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setfill</span><span class="p">(</span><span class="sc">&#39;0&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">m_pktData</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">mac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="n">mac</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">mac</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseIPV4</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">ip</span><span class="p">;</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="n">pos</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">m_pktData</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="n">ip</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ip</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseIPV6</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">ip</span><span class="p">;</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">m_pktData</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">m_pktData</span><span class="p">[</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">continue</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setfill</span><span class="p">(</span><span class="sc">&#39;0&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">m_pktData</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setfill</span><span class="p">(</span><span class="sc">&#39;0&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">m_pktData</span><span class="p">[</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="n">ip</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ip</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">	</span><span class="n">result</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// Each byte will be represented by 2 hexadecimal characters</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"> </span><span class="n">pos</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="w">		</span><span class="n">sprintf_s</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%02x&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">m_pktData</span><span class="p">[</span><span class="n">pos</span><span class="p">]);</span>
<span class="w">		</span><span class="n">result</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">uint64_t</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">htonll</span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">htonl</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="c1">// The system is already in network byte order</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="c1">// Swap the bytes</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">((</span><span class="kt">uint64_t</span><span class="p">)</span><span class="n">htonl</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">htonl</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">htoni</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">htons</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="c1">// The system is already in network byte order</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="c1">// Swap the bytes</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">htons</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">htons</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseLongLong</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">out</span><span class="p">;</span>

<span class="w">	</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">m_pktData</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>

<span class="w">	</span><span class="n">pos</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">len</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">htonll</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">long</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseLong</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="n">out</span><span class="p">;</span>

<span class="w">	</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">m_pktData</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>

<span class="w">	</span><span class="n">pos</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">len</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">htonl</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseInt</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">out</span><span class="p">;</span>

<span class="w">	</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">m_pktData</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>

<span class="w">	</span><span class="n">pos</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">len</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">htoni</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">short</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">parseShort</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">short</span><span class="w"> </span><span class="n">out</span><span class="p">;</span>

<span class="w">	</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">m_pktData</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>

<span class="w">	</span><span class="n">pos</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">len</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">htons</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">getTexts</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_texts</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">struct</span><span class="w"> </span><span class="nc">tm</span><span class="w"> </span><span class="n">timeinfo</span><span class="p">;</span>
<span class="w">		</span><span class="kt">time_t</span><span class="w"> </span><span class="n">epoch_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">time_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m_epoch</span><span class="p">);</span>
<span class="w">		</span><span class="n">localtime_s</span><span class="p">(</span><span class="o">&amp;</span><span class="n">timeinfo</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">epoch_t</span><span class="p">);</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1900</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeinfo</span><span class="p">.</span><span class="n">tm_year</span><span class="p">;</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">padDate</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeinfo</span><span class="p">.</span><span class="n">tm_mon</span><span class="p">);</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">padDate</span><span class="p">(</span><span class="n">timeinfo</span><span class="p">.</span><span class="n">tm_mday</span><span class="p">);</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">hour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">padDate</span><span class="p">(</span><span class="n">timeinfo</span><span class="p">.</span><span class="n">tm_hour</span><span class="p">);</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">padDate</span><span class="p">(</span><span class="n">timeinfo</span><span class="p">.</span><span class="n">tm_min</span><span class="p">);</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">sec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">padDate</span><span class="p">(</span><span class="n">timeinfo</span><span class="p">.</span><span class="n">tm_sec</span><span class="p">);</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;{}/{}/{} {}:{}:{}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">day</span><span class="p">,</span><span class="w"> </span><span class="n">hour</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">,</span><span class="w"> </span><span class="n">sec</span><span class="p">);</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;title&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Frame {}: {} bytes on wire ({} bits)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_idx</span><span class="p">,</span><span class="w"> </span><span class="n">m_len</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">m_len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">));</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">		</span><span class="n">result</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">m_len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// Each byte will be represented by 2 hexadecimal characters</span>

<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="w">			</span><span class="n">sprintf_s</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%02x&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">m_pktData</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">			</span><span class="n">result</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;hexData&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">m_texts</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ctime&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;WinSock2.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;json.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;imgui.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;GLFW/glfw3.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;map&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../../GUI/Renderer.h&quot;</span>

<span class="k">using</span><span class="w"> </span><span class="n">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlohmann</span><span class="o">::</span><span class="n">ordered_json</span><span class="p">;</span>

<span class="c1">// *slaps roof of class* this bad boy can fit so many members in it</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Packet</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_idx</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_idxStr</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_description</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_expands</span><span class="p">;</span>

<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">	</span><span class="c1">// header stuff</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">m_epoch</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_len</span><span class="p">;</span>

<span class="w">	</span><span class="c1">// ether stuff</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_phyDst</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_phySrc</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_type</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_strType</span><span class="p">;</span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">m_pktData</span><span class="p">;</span>

<span class="w">	</span><span class="n">Packet</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Packet</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">render</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">renderExpanded</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">renderExpanded</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">();</span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="n">json</span><span class="w"> </span><span class="nf">jsonify</span><span class="p">();</span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getTexts</span><span class="p">();</span>

<span class="k">protected</span><span class="o">:</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_texts</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">parseMAC</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">parseIPV4</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">parseIPV6</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">parseLongLong</span><span class="p">();</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="nf">parseLong</span><span class="p">();</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="nf">parseInt</span><span class="p">();</span>
<span class="w">	</span><span class="kt">short</span><span class="w"> </span><span class="nf">parseShort</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">padDate</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">	</span><span class="kt">uint64_t</span><span class="w"> </span><span class="nf">htonll</span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="nf">htoni</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV4.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV6.h&quot;</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV4.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../../Base/Logger.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../Capture.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bitset&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ws2def.h&gt;</span>

<span class="n">IPV4</span><span class="o">::</span><span class="n">IPV4</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Packet</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="p">;</span>
<span class="w">	</span><span class="n">m_headerLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pkt_data</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0000FFFF</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">	</span><span class="n">m_differServ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>

<span class="w">	</span><span class="n">m_totalLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_identification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pkt_data</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFFF00000</span><span class="p">);</span>

<span class="w">	</span><span class="n">m_fragmentationOffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseShort</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">8191</span><span class="p">;</span>

<span class="w">	</span><span class="n">m_ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>

<span class="w">	</span><span class="n">m_proto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>

<span class="w">	</span><span class="n">m_headerChecksum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_srcAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseIPV4</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_destAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseIPV4</span><span class="p">();</span>

<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">m_headerLength</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">start</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pos</span><span class="p">;</span>

<span class="w">	</span><span class="n">m_IPoptionsCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">diff</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_IPoptionsCount</span><span class="o">++</span><span class="p">;</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="p">;</span>

<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">31</span><span class="p">;</span>

<span class="w">		</span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">routerAlert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>

<span class="w">		</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">routerAlert</span><span class="p">:</span>
<span class="w">			</span><span class="n">m_opts</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">RouterAlert</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pos</span><span class="p">));</span>
<span class="w">			</span><span class="n">m_optSize</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">m_opts</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">m_opts</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">m_length</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">default</span><span class="o">:</span>
<span class="cp">#ifdef _DEBUG</span>
<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;bad ip option of packet data: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">code</span><span class="p">;</span>
<span class="w">			</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="w">			</span><span class="n">Capture</span><span class="o">::</span><span class="n">dump</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">);</span>
<span class="w">			</span><span class="n">pos</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">diff</span><span class="p">;</span>
<span class="w">			</span><span class="n">diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">diff</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="p">(</span><span class="n">pos</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span>
<span class="w">		</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;option %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_IPoptionsCount</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="nb">false</span><span class="p">});</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;IPV4&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;IPV4 Title&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;DifferServ&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;Flags&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="n">m_expands</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;Options General&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">});</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">IPV4</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IPV4 Packet at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; of length &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_totalLength</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; from &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_srcAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; to &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_destAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; transfer protocol is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_proto</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; with options: &quot;</span><span class="p">;</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_IPoptionsCount</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_opts</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">json</span><span class="w"> </span><span class="n">IPV4</span><span class="o">::</span><span class="n">jsonify</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">jsonify</span><span class="p">();</span>

<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;IPV4&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;start&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;IPV4 Header Length&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_headerLength</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Differentiated Services&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_differServ</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Total Length&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_totalLength</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Identification&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_identification</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Flags&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_flags</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Fragmentation Offset&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_fragmentationOffset</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Time to Live&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_ttl</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;protocol&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_proto</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;IPV4 Checksum&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_headerChecksum</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Source Address&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_srcAddr</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Destination Address&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_destAddr</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;IP Options Count&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_IPoptionsCount</span><span class="p">;</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_IPoptionsCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_IPoptionsCount</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_opts</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;IP Options&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">IPV4</span><span class="o">::</span><span class="n">getTexts</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_texts</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Packet</span><span class="o">::</span><span class="n">getTexts</span><span class="p">();</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;IPTitle&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Internet Protocol Version 4, Src: {}, Dst: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_srcAddr</span><span class="p">,</span><span class="w"> </span><span class="n">m_destAddr</span><span class="p">);</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;headerLen&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">.... {} = Header Length: {} bytes ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bitset</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m_headerLength</span><span class="p">).</span><span class="n">to_string</span><span class="p">(),</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">m_headerLength</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">m_headerLength</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span>

<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">dscp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_differServ</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFFFFFF00</span><span class="p">;</span>

<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">ecn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_differServ</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x000000FF</span><span class="p">;</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;differServ&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;   Differentiated Services Field: {}, (DSCP: {}, ECN: {})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_differServ</span><span class="p">,</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">dscpMap</span><span class="p">[</span><span class="n">dscp</span><span class="p">],</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">ecnMap</span><span class="p">[</span><span class="n">ecn</span><span class="p">]);</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">bitset</span><span class="o">&lt;</span><span class="mi">6</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dscpBits</span><span class="p">;</span>
<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">dscpBits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">m_differServ</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">bitset</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ecnBits</span><span class="p">;</span>
<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ecnBits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">m_differServ</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;DSCP&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t</span><span class="s">{}.. = Differentiated Services Codepoint: {} ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dscpBits</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">dscpMap</span><span class="p">[</span><span class="n">dscp</span><span class="p">],</span><span class="w"> </span><span class="n">dscp</span><span class="p">);</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;ECN&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t</span><span class="s">......{} = Explicit Congestion Notification: {} ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ecnBits</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"> </span><span class="n">Data</span><span class="o">::</span><span class="n">ecnMap</span><span class="p">[</span><span class="n">ecn</span><span class="p">],</span><span class="w"> </span><span class="n">ecn</span><span class="p">);</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;ID&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Identification: 0x{:x} ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_identification</span><span class="p">,</span><span class="w"> </span><span class="n">m_identification</span><span class="p">);</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">bitset</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="n">flagBits</span><span class="p">;</span>
<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">flagBits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">m_flags</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;IPFlags&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;   {}. .... = Flags: 0x{:x}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">flagBits</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">m_flags</span><span class="p">);</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;resBits&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t\t</span><span class="s">{}... .... = Reserved bit: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">flagBits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">flagBits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;Set&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Not Set&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;dfBits&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t\t</span><span class="s">.{}.. .... = Don&#39;t Fragment: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">flagBits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">flagBits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;Set&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Not Set&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;mfBits&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t\t</span><span class="s">..{}. .... = More Fragments: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">flagBits</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">flagBits</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;Set&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Not Set&quot;</span><span class="p">);</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">bitset</span><span class="o">&lt;</span><span class="mi">13</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fragBits</span><span class="p">;</span>
<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">13</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">fragBits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">m_fragmentationOffset</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;offset&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">...{} = Fragmentation Offset: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fragBits</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"> </span><span class="n">m_fragmentationOffset</span><span class="p">);</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">prot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Unknown&quot;</span><span class="p">;</span>

<span class="w">		</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">m_proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_TCP</span><span class="p">:</span>
<span class="w">			</span><span class="n">prot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;TCP&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_UDP</span><span class="p">:</span>
<span class="w">			</span><span class="n">prot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;UDP&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_IGMP</span><span class="p">:</span>
<span class="w">			</span><span class="n">prot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;IGMP&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">IPPROTO_ICMP</span><span class="p">:</span>
<span class="w">			</span><span class="n">prot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ICMP&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;proto&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Protocol: {} ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">prot</span><span class="p">,</span><span class="w"> </span><span class="n">m_proto</span><span class="p">);</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;IPChecksum&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Header Checksum: {:x}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_headerChecksum</span><span class="p">);</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;src&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Source Address: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_srcAddr</span><span class="p">);</span>

<span class="w">		</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;dest&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Destination Address: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_destAddr</span><span class="p">);</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_IPoptionsCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;   Options: (&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_optSize</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; bytes): &quot;</span><span class="p">;</span>

<span class="w">			</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_IPoptionsCount</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_opts</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">m_name</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="p">;</span>
<span class="w">			</span><span class="p">}</span>

<span class="w">			</span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;optStr&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_IPoptionsCount</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">auto</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_opts</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">			</span><span class="n">m_optButtons</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">   IP Option - {} ({} bytes): {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="o">-&gt;</span><span class="n">m_name</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="o">-&gt;</span><span class="n">m_length</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="o">-&gt;</span><span class="n">m_value</span><span class="p">));</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">m_texts</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../Eth/Packet.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV4Options/IPV4Options.h&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IPV4</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Packet</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">m_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">m_headerLength</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">m_differServ</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_totalLength</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_identification</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">m_flags</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_fragmentationOffset</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">m_ttl</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">m_proto</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_headerChecksum</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_srcAddr</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_destAddr</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_IPoptionsCount</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">IPV4Option</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">m_opts</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_optButtons</span><span class="p">;</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="n">m_optSize</span><span class="p">;</span>

<span class="w">	</span><span class="n">IPV4</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="o">~</span><span class="n">IPV4</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">	</span><span class="n">json</span><span class="w"> </span><span class="nf">jsonify</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">render</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">renderExpanded</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Renderer</span><span class="o">::</span><span class="n">renderExpanded</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getTexts</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV4Option.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>

<span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">IPV4Option::parseLong</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">start</span><span class="p">);</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">start</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">start</span><span class="p">)</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">out</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">start</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">out</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">IPV4Option</span><span class="o">::</span><span class="n">IPV4Option</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_opCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">code</span><span class="p">;</span>
<span class="w">	</span><span class="n">m_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">IPV4Option</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Unknown option of code &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_opCode</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IPV4Option</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_opCode</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_name</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_value</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_length</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>

<span class="w">	</span><span class="n">IPV4Option</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">();</span>

<span class="k">protected</span><span class="o">:</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">parseLong</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV4Option.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;RouterAlert.h&quot;</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;RouterAlert.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;format&gt;</span>

<span class="n">RouterAlert</span><span class="o">::</span><span class="n">RouterAlert</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IPV4Option</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Router Alert&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_copyOnFrag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="o">*</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x10000000</span><span class="p">;</span>
<span class="w">	</span><span class="n">m_clsType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="o">*</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x01100000</span><span class="p">;</span>
<span class="w">	</span><span class="n">m_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="o">*</span><span class="n">pos</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x00011111</span><span class="p">;</span>

<span class="w">	</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">;</span>

<span class="w">	</span><span class="n">m_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">];</span>

<span class="w">	</span><span class="n">m_extra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">parseLong</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m_length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">);</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_extra</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Router Shall examine Packet (0)&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_extra</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_extra</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">33</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Aggregated Reservation Nesting Level {} ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_extra</span><span class="p">,</span><span class="w"> </span><span class="n">m_extra</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_extra</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_extra</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">65</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Aggregated Reservation Nesting Level {} ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_extra</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">33</span><span class="p">,</span><span class="w"> </span><span class="n">m_extra</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_extra</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">65</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NSIS NATFW NSLP (65)&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Bad Router Alert Code {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_extra</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">data</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t\t</span><span class="s">Copy on fragmentation: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_copyOnFrag</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;Yes&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;No&quot;</span><span class="p">));</span>
<span class="w">	</span><span class="n">data</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t\t</span><span class="s">Class Type Code: {} ({})&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_clsType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;Control&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Debugging and measurement&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_clsType</span><span class="p">));</span>
<span class="w">	</span><span class="n">data</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t\t\t</span><span class="s">Number: Router Alert (20)&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">RouterAlert</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Route Alert Option of length &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_length</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV4Option.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RouterAlert</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IPV4Option</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">bool</span><span class="w"> </span><span class="n">m_copyOnFrag</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_clsType</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_code</span><span class="p">;</span>
<span class="w">	</span><span class="kt">long</span><span class="w"> </span><span class="n">m_extra</span><span class="p">;</span>

<span class="w">	</span><span class="n">RouterAlert</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV6.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../../../../GUI/Renderer.h&quot;</span>

<span class="n">IPV6</span><span class="o">::</span><span class="n">IPV6</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Packet</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">thingy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseLong</span><span class="p">();</span>
<span class="w">	</span><span class="n">m_trafficCls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">thingy</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">4080</span><span class="p">;</span>

<span class="w">	</span><span class="n">m_flowLabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">thingy</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1048575</span><span class="p">;</span>

<span class="w">	</span><span class="n">m_payloadLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseShort</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_nextHeader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>

<span class="w">	</span><span class="n">m_hopLimit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>

<span class="w">	</span><span class="n">m_srcAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseIPV6</span><span class="p">();</span>

<span class="w">	</span><span class="n">m_destAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseIPV6</span><span class="p">();</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_nextHeader</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IPPROTO_HOPOPTS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_options</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">HopByHop</span><span class="p">(</span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pos</span><span class="p">));</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">Packet</span><span class="o">::</span><span class="n">m_strType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;IPV6&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">IPV6</span><span class="o">::</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;IPV6 Packet at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_texts</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; of length &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; from &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_srcAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; to &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_destAddr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;of payload length: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; transfer protocol is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_nextHeader</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">json</span><span class="w"> </span><span class="n">IPV6</span><span class="o">::</span><span class="n">jsonify</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Packet</span><span class="o">::</span><span class="n">jsonify</span><span class="p">();</span>

<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;IPV6&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;start&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Version&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_version</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Traffic Class&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_trafficCls</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Flow Label&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_flowLabel</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Payload Length&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Protocol&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_nextHeader</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Hop Limit&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_hopLimit</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Source Address&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_srcAddr</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Destination Address&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_destAddr</span><span class="p">;</span>
<span class="w">	</span><span class="n">j</span><span class="p">[</span><span class="s">&quot;Header Length&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_headerLength</span><span class="p">;</span>

<span class="w">	</span><span class="cm">/*if (m_options.size() &gt; 0) {</span>
<span class="cm">		j[&quot;option&quot;] = m_options.at(0).toString();</span>
<span class="cm">	}*/</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">IPV6</span><span class="o">::</span><span class="n">render</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">Renderer</span><span class="o">::</span><span class="n">render</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../Eth/Packet.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV6Options/IPV6Options.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IPV6</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Packet</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">m_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_trafficCls</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">m_flowLabel</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_payloadLength</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">m_nextHeader</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">m_hopLimit</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_srcAddr</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_destAddr</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">IPV6Option</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">m_options</span><span class="p">;</span>

<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_headerLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">40</span><span class="p">;</span>

<span class="w">	</span><span class="n">IPV6</span><span class="p">(</span><span class="n">pcap_pkthdr</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<span class="w">	</span><span class="o">~</span><span class="n">IPV6</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">	</span><span class="n">json</span><span class="w"> </span><span class="nf">jsonify</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;HopByHop.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="n">HopByHop</span><span class="o">::</span><span class="n">HopByHop</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IPV6Option</span><span class="p">(</span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m_length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="o">*</span><span class="n">pos</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">end</span><span class="p">;)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_options</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV6Option.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;HopOptions/HopOption.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HopByHop</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IPV6Option</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HopOption</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_options</span><span class="p">;</span>

<span class="w">	</span><span class="n">HopByHop</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;HopOption.h&quot;</span>

<span class="n">HopOption</span><span class="o">::</span><span class="n">HopOption</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">];</span>
<span class="w">	</span><span class="n">m_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">];</span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_length</span><span class="p">;</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">m_data</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// Each byte will be represented by 2 hexadecimal characters</span>

<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="w">			</span><span class="n">sprintf_s</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%02x&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)]);</span>
<span class="w">			</span><span class="n">m_data</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HopOption</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_type</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_length</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_data</span><span class="p">;</span>

<span class="w">	</span><span class="n">HopOption</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV6Option.h&quot;</span>

<span class="n">IPV6Option</span><span class="o">::</span><span class="n">IPV6Option</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">m_nextHeader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">];</span>
<span class="w">	</span><span class="n">m_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">[(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span><span class="o">++</span><span class="p">];</span>
<span class="w">	</span><span class="n">m_pktData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pcap.h&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IPV6Option</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_nextHeader</span><span class="p">;</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">m_length</span><span class="p">;</span>

<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">m_pktData</span><span class="p">;</span>

<span class="w">	</span><span class="n">IPV6Option</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*</span><span class="w"> </span><span class="n">pkt_data</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IPV6Option.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;HopByHop.h&quot;</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Eth/Eth.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IP/IP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Data/ICMP/ICMP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Data/ICMP/ICMPV6.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Data/IGMP/IGMP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Data/TCP/TCP.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Data/UDP/UDP.h&quot;</span>

<span class="cp">#define PKT             Packet*</span>
<span class="cp">#define ARP_PKT         ARP*</span>
<span class="cp">#define IPV4_PKT        IPV4*</span>
<span class="cp">#define TCPV4_PKT       TCP&lt;IPV4&gt;*</span>
<span class="cp">#define UDPV4_PKT       UDP&lt;IPV4&gt;*</span>
<span class="cp">#define IGMPV4_PKT      IGMP&lt;IPV4&gt;*</span>
<span class="cp">#define ICMPV4_PKT      ICMP*</span>
<span class="cp">#define IPV6_PKT        IPV6*</span>
<span class="cp">#define TCPV6_PKT       TCP&lt;IPV6&gt;*</span>
<span class="cp">#define UDPV6_PKT       UDP&lt;IPV6&gt;*</span>
<span class="cp">#define IGMPV6_PKT      IGMP&lt;IPV6&gt;*</span>
<span class="cp">#define ICMPV6_PKT      ICMPV6*</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#define _WINSOCK_DEPRECATED_NO_WARNINGS</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;SDK.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;../Base/Logger.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;array&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Psapi.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tchar.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;IcmpAPI.h&gt;</span>
<span class="c1">// #include &quot;../base/Structs.h&quot;</span>

<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">DWORD</span><span class="p">,</span><span class="w"> </span><span class="n">DWORD</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">PORT2PID</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">DWORD</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">PID2PROC</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">ipAddress</span><span class="p">;</span>
<span class="n">HANDLE</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">hIcmpFile</span><span class="p">;</span>
<span class="n">DWORD</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">dwRetVal</span><span class="p">;</span>
<span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">SendData</span><span class="p">;</span>
<span class="n">LPVOID</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">ReplyBuffer</span><span class="p">;</span>
<span class="n">DWORD</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">ReplySize</span><span class="p">;</span>
<span class="n">IP_OPTION_INFORMATION</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">ipOptions</span><span class="p">;</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">SDK::exec</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">cmd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer</span><span class="p">{};</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="kt">FILE</span><span class="p">,</span><span class="w"> </span><span class="k">decltype</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_pclose</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pipe</span><span class="p">(</span><span class="n">_popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;rt&quot;</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">_pclose</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pipe</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">Logger</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;popen() failed!&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">fgets</span><span class="p">(</span><span class="n">buffer</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">pipe</span><span class="p">.</span><span class="n">get</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">result</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">buffer</span><span class="p">.</span><span class="n">data</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">json</span><span class="w"> </span><span class="nf">SDK::geoLocate</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">addr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sa">R</span><span class="s">&quot;</span><span class="dl">(</span><span class="s">curl -s -H &quot;User-Agent: keycdn-tools:https://amalb.iscool.co.il/&quot; &quot;https://tools.keycdn.com/geo.json?host=&quot;</span><span class="dl">)</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">cmd</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">addr</span><span class="p">;</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">exec</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SDK::initPIDCache</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">tasklist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exec</span><span class="p">(</span><span class="s">&quot;tasklist&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="kt">size_t</span><span class="w"> </span><span class="n">pos</span><span class="p">;</span>
<span class="w">	</span><span class="kt">size_t</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="kt">size_t</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tasklist</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot; Services&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="kt">size_t</span><span class="w"> </span><span class="n">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tasklist</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot; Console&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">;</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ps</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">			</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; Console&quot;</span><span class="p">;</span>
<span class="w">			</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pc</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; Services&quot;</span><span class="p">;</span>
<span class="w">				</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ps</span><span class="p">;</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">			</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; Console&quot;</span><span class="p">;</span>
<span class="w">					</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pc</span><span class="p">;</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">				</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">					</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; Services&quot;</span><span class="p">;</span>
<span class="w">					</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ps</span><span class="p">;</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="w">		</span><span class="n">pos</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">		</span><span class="n">DWORD</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">		</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">isdigit</span><span class="p">(</span><span class="n">tasklist</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">pos</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">pid</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">(</span><span class="n">tasklist</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">48</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="o">++</span><span class="p">);</span>
<span class="w">			</span><span class="n">pos</span><span class="o">--</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">tasklist</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">;</span><span class="w"> </span><span class="n">pos</span><span class="o">--</span><span class="p">);</span>

<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">		</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">tasklist</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tasklist</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">			</span><span class="n">pos</span><span class="o">--</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PID2PROC</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pid</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">PID2PROC</span><span class="p">.</span><span class="n">try_emplace</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="n">tasklist</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">length</span><span class="p">());</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="n">PMIB_TCPTABLE_OWNER_PID</span><span class="w"> </span><span class="nf">SDK::getTCPTable</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">DWORD</span><span class="w"> </span><span class="n">dwSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">	</span><span class="n">PMIB_TCPTABLE_OWNER_PID</span><span class="w"> </span><span class="n">pTcpTable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>

<span class="w">	</span><span class="c1">// Get the required buffer size</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GetExtendedTcpTable</span><span class="p">(</span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dwSize</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">AF_INET</span><span class="p">,</span><span class="w"> </span><span class="n">TCP_TABLE_OWNER_PID_ALL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ERROR_INSUFFICIENT_BUFFER</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to get required buffer size&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="c1">// Allocate memory for the TCP table</span>
<span class="w">	</span><span class="n">pTcpTable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">PMIB_TCPTABLE_OWNER_PID</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">dwSize</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pTcpTable</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to allocate memory for TCP table&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="c1">// Get the TCP table</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GetExtendedTcpTable</span><span class="p">(</span><span class="n">pTcpTable</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dwSize</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">AF_INET</span><span class="p">,</span><span class="w"> </span><span class="n">TCP_TABLE_OWNER_PID_ALL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NO_ERROR</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to get TCP table&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">		</span><span class="n">free</span><span class="p">(</span><span class="n">pTcpTable</span><span class="p">);</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">pTcpTable</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SDK::refreshTCP</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">getTCPTable</span><span class="p">();</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">DWORD</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">table</span><span class="o">-&gt;</span><span class="n">dwNumEntries</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">table</span><span class="o">-&gt;</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">		</span><span class="n">u_short</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ntohs</span><span class="p">((</span><span class="n">u_short</span><span class="p">)</span><span class="n">row</span><span class="p">.</span><span class="n">dwLocalPort</span><span class="p">);</span>
<span class="w">		</span><span class="n">DWORD</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row</span><span class="p">.</span><span class="n">dwOwningPid</span><span class="p">;</span>
<span class="w">		</span><span class="n">PORT2PID</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="n">PMIB_UDPTABLE_OWNER_PID</span><span class="w"> </span><span class="nf">SDK::getUDPTable</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">DWORD</span><span class="w"> </span><span class="n">dwSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">	</span><span class="n">PMIB_UDPTABLE_OWNER_PID</span><span class="w"> </span><span class="n">pUdpTable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>

<span class="w">	</span><span class="c1">// Get the required buffer size</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GetExtendedUdpTable</span><span class="p">(</span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dwSize</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">AF_INET</span><span class="p">,</span><span class="w"> </span><span class="n">UDP_TABLE_OWNER_PID</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ERROR_INSUFFICIENT_BUFFER</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to get required buffer size&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="c1">// Allocate memory for the TCP table</span>
<span class="w">	</span><span class="n">pUdpTable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">PMIB_UDPTABLE_OWNER_PID</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">dwSize</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pUdpTable</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to allocate memory for TCP table&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="c1">// Get the TCP table</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GetExtendedUdpTable</span><span class="p">(</span><span class="n">pUdpTable</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dwSize</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">AF_INET</span><span class="p">,</span><span class="w"> </span><span class="n">UDP_TABLE_OWNER_PID</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NO_ERROR</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to get UDP table&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">		</span><span class="n">free</span><span class="p">(</span><span class="n">pUdpTable</span><span class="p">);</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">pUdpTable</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SDK::refreshUDP</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">getUDPTable</span><span class="p">();</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">DWORD</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">table</span><span class="o">-&gt;</span><span class="n">dwNumEntries</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">table</span><span class="o">-&gt;</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">		</span><span class="n">u_short</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ntohs</span><span class="p">((</span><span class="n">u_short</span><span class="p">)</span><span class="n">row</span><span class="p">.</span><span class="n">dwLocalPort</span><span class="p">);</span>
<span class="w">		</span><span class="n">DWORD</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row</span><span class="p">.</span><span class="n">dwOwningPid</span><span class="p">;</span>
<span class="w">		</span><span class="n">PORT2PID</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="p">});</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SDK::refreshTables</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">refreshTCP</span><span class="p">();</span>
<span class="w">	</span><span class="n">refreshUDP</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SDK::findIP</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">adName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">ULONG</span><span class="w"> </span><span class="n">buffer_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">IP_ADAPTER_INFO</span><span class="p">);</span>
<span class="w">	</span><span class="n">IP_ADAPTER_INFO</span><span class="o">*</span><span class="w"> </span><span class="n">adapter_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">IP_ADAPTER_INFO</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">);</span>

<span class="w">	</span><span class="c1">// Get the adapter information</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GetAdaptersInfo</span><span class="p">(</span><span class="n">adapter_info</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">buffer_size</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ERROR_BUFFER_OVERFLOW</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">free</span><span class="p">(</span><span class="n">adapter_info</span><span class="p">);</span>
<span class="w">		</span><span class="n">adapter_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">IP_ADAPTER_INFO</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">);</span>
<span class="w">		</span><span class="n">GetAdaptersInfo</span><span class="p">(</span><span class="n">adapter_info</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">buffer_size</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">ad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">adName</span><span class="p">;</span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ad</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ad</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;_&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ad</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ad</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">ad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>

<span class="w">	</span><span class="c1">// Print the IP addresses</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">IP_ADAPTER_INFO</span><span class="o">*</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">adapter_info</span><span class="p">;</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">Next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="cm">/*std::cout &lt;&lt; &quot;Adapter name: &quot; &lt;&lt; adapter-&gt;AdapterName &lt;&lt; std::endl;</span>
<span class="cm">		std::cout &lt;&lt; &quot;IP address: &quot; &lt;&lt; adapter-&gt;IpAddressList.IpAddress.String &lt;&lt; std::endl;</span>
<span class="cm">		std::cout &lt;&lt; &quot;Subnet mask: &quot; &lt;&lt; adapter-&gt;IpAddressList.IpMask.String &lt;&lt; std::endl;</span>
<span class="cm">		std::cout &lt;&lt; std::endl;*/</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">AdapterName</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ad</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">ipAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">IpAddressList</span><span class="p">.</span><span class="n">IpAddress</span><span class="p">.</span><span class="n">String</span><span class="p">;</span>
<span class="w">			</span><span class="k">break</span><span class="p">;</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">free</span><span class="p">(</span><span class="n">adapter_info</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SDK::initICMP</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// Initialize variables</span>
<span class="w">	</span><span class="n">dwRetVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Data Buffer&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="n">SendData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">char</span><span class="p">[</span><span class="n">temp</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">ranges</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="n">SendData</span><span class="p">);</span>
<span class="w">	</span><span class="n">SendData</span><span class="p">[</span><span class="n">temp</span><span class="p">.</span><span class="n">size</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<span class="w">	</span><span class="n">ReplyBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">	</span><span class="n">ReplySize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">	</span><span class="n">ipOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span>

<span class="w">	</span><span class="c1">// Open ICMP handle</span>
<span class="w">	</span><span class="n">hIcmpFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IcmpCreateFile</span><span class="p">();</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hIcmpFile</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unable to open ICMP handle</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="c1">// Set reply buffer size</span>
<span class="w">	</span><span class="n">ReplySize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">ICMP_ECHO_REPLY</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">SendData</span><span class="p">);</span>
<span class="w">	</span><span class="n">ReplyBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">VOID</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">ReplySize</span><span class="p">);</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ReplyBuffer</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unable to allocate memory for reply buffer</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SDK::init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="n">initPIDCache</span><span class="p">();</span>
<span class="w">	</span><span class="n">refreshTables</span><span class="p">();</span>
<span class="w">	</span><span class="n">initICMP</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SDK::release</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// Cleanup</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ReplyBuffer</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">free</span><span class="p">(</span><span class="n">ReplyBuffer</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="n">IcmpCloseHandle</span><span class="p">(</span><span class="n">hIcmpFile</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">DWORD</span><span class="w"> </span><span class="nf">SDK::getPIDFromPort</span><span class="p">(</span><span class="n">DWORD</span><span class="w"> </span><span class="n">port</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PORT2PID</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">port</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">PORT2PID</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">refreshTables</span><span class="p">();</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PORT2PID</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">port</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">PORT2PID</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">MAXDWORD</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">SDK::getProcFromPID</span><span class="p">(</span><span class="n">DWORD</span><span class="w"> </span><span class="n">PID</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MAXDWORD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&lt;UNKNOWN&gt;&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PID2PROC</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">PID</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">PID2PROC</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">PID</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">TCHAR</span><span class="w"> </span><span class="n">szProcessName</span><span class="p">[</span><span class="n">MAX_PATH</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">&quot;4&quot;</span><span class="p">);</span>
<span class="w">	</span><span class="n">HANDLE</span><span class="w"> </span><span class="n">hProcess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OpenProcess</span><span class="p">(</span><span class="n">PROCESS_QUERY_INFORMATION</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">PROCESS_VM_READ</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">PID</span><span class="p">);</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hProcess</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&lt;BADPROCESS&gt;&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">GetModuleBaseName</span><span class="p">(</span><span class="n">hProcess</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="n">szProcessName</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">szProcessName</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&lt;NAMELESS&gt;&quot;</span><span class="p">;</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">processName</span><span class="p">;</span>

<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">size_needed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WideCharToMultiByte</span><span class="p">(</span><span class="n">CP_UTF8</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">szProcessName</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer</span><span class="p">(</span><span class="n">size_needed</span><span class="p">);</span>
<span class="w">	</span><span class="n">WideCharToMultiByte</span><span class="p">(</span><span class="n">CP_UTF8</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">szProcessName</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">size_needed</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">	</span><span class="n">processName</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">buffer</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer</span><span class="p">.</span><span class="n">end</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// -1 to remove the null terminator</span>

<span class="w">	</span><span class="n">CloseHandle</span><span class="p">(</span><span class="n">hProcess</span><span class="p">);</span>

<span class="w">	</span><span class="n">PID2PROC</span><span class="p">.</span><span class="n">try_emplace</span><span class="p">(</span><span class="n">PID</span><span class="p">,</span><span class="w"> </span><span class="n">processName</span><span class="p">);</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">processName</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">SDK::getProcFromPort</span><span class="p">(</span><span class="n">DWORD</span><span class="w"> </span><span class="n">port</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">getProcFromPID</span><span class="p">(</span><span class="n">getPIDFromPort</span><span class="p">(</span><span class="n">port</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">traceRoute</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">addr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">ipaddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INADDR_NONE</span><span class="p">;</span>
<span class="w">	</span><span class="c1">// Convert IP address string to binary</span>
<span class="w">	</span><span class="n">ipaddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inet_addr</span><span class="p">(</span><span class="n">addr</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ipaddr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">INADDR_NONE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unable to parse IP address</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">		</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="n">u_char</span><span class="w"> </span><span class="n">ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">addrs</span><span class="p">;</span>

<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="n">ipOptions</span><span class="p">.</span><span class="n">Ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ttl</span><span class="o">++</span><span class="p">;</span>
<span class="w">		</span><span class="c1">// Send ICMP echo request</span>
<span class="w">		</span><span class="n">dwRetVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IcmpSendEcho</span><span class="p">(</span><span class="n">hIcmpFile</span><span class="p">,</span><span class="w"> </span><span class="n">ipaddr</span><span class="p">,</span><span class="w"> </span><span class="n">SendData</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">SendData</span><span class="p">),</span>
<span class="w">			</span><span class="o">&amp;</span><span class="n">ipOptions</span><span class="p">,</span><span class="w"> </span><span class="n">ReplyBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">ReplySize</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dwRetVal</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">PICMP_ECHO_REPLY</span><span class="w"> </span><span class="n">pEchoReply</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">PICMP_ECHO_REPLY</span><span class="p">)</span><span class="n">ReplyBuffer</span><span class="p">;</span>
<span class="w">			</span><span class="k">struct</span><span class="w"> </span><span class="nc">in_addr</span><span class="w"> </span><span class="n">ReplyAddr</span><span class="p">;</span>
<span class="w">			</span><span class="n">ReplyAddr</span><span class="p">.</span><span class="n">S_un</span><span class="p">.</span><span class="n">S_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pEchoReply</span><span class="o">-&gt;</span><span class="n">Address</span><span class="p">;</span>
<span class="w">			</span><span class="cm">/*printf(&quot;Received %ld ICMP echo replies from %s\n&quot;, dwRetVal, inet_ntoa(ReplyAddr));</span>
<span class="cm">			printf(&quot;Status: %ld\n&quot;, pEchoReply-&gt;Status);</span>
<span class="cm">			printf(&quot;Round trip time: %ld milliseconds\n&quot;, pEchoReply-&gt;RoundTripTime);*/</span>
<span class="w">			</span><span class="n">addrs</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">inet_ntoa</span><span class="p">(</span><span class="n">ReplyAddr</span><span class="p">));</span>

<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pEchoReply</span><span class="o">-&gt;</span><span class="n">Status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">				</span><span class="k">break</span><span class="p">;</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">			</span><span class="n">DWORD</span><span class="w"> </span><span class="n">errorMessageID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetLastError</span><span class="p">();</span>

<span class="w">			</span><span class="n">LPSTR</span><span class="w"> </span><span class="n">messageBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">			</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FormatMessageA</span><span class="p">(</span>
<span class="w">				</span><span class="n">FORMAT_MESSAGE_ALLOCATE_BUFFER</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">FORMAT_MESSAGE_FROM_SYSTEM</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">FORMAT_MESSAGE_IGNORE_INSERTS</span><span class="p">,</span>
<span class="w">				</span><span class="nb">NULL</span><span class="p">,</span>
<span class="w">				</span><span class="n">errorMessageID</span><span class="p">,</span>
<span class="w">				</span><span class="n">MAKELANGID</span><span class="p">(</span><span class="n">LANG_NEUTRAL</span><span class="p">,</span><span class="w"> </span><span class="n">SUBLANG_DEFAULT</span><span class="p">),</span>
<span class="w">				</span><span class="p">(</span><span class="n">LPSTR</span><span class="p">)</span><span class="o">&amp;</span><span class="n">messageBuffer</span><span class="p">,</span>
<span class="w">				</span><span class="mi">0</span><span class="p">,</span>
<span class="w">				</span><span class="nb">NULL</span>
<span class="w">			</span><span class="p">);</span>
<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">			</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;error: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">messageBuffer</span><span class="p">;</span>
<span class="w">			</span><span class="n">addrs</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">());</span>
<span class="w">			</span><span class="n">LocalFree</span><span class="p">(</span><span class="n">messageBuffer</span><span class="p">);</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">addrs</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">json</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SDK</span><span class="o">::</span><span class="n">geoTrace</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">addr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">vec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traceRoute</span><span class="p">(</span><span class="n">addr</span><span class="p">);</span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">json</span><span class="o">&gt;</span><span class="w"> </span><span class="n">locs</span><span class="p">;</span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">vec</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">geoLocate</span><span class="p">(</span><span class="n">add</span><span class="p">);</span>
<span class="w">		</span><span class="n">locs</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">locs</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;map&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;WinSock2.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iphlpapi.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;json.hpp&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="n">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlohmann</span><span class="o">::</span><span class="n">ordered_json</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SDK</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">ipAddress</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">findIP</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">adName</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">exec</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">cmd</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">release</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">DWORD</span><span class="w"> </span><span class="nf">getPIDFromPort</span><span class="p">(</span><span class="n">DWORD</span><span class="w"> </span><span class="n">port</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">getProcFromPID</span><span class="p">(</span><span class="n">DWORD</span><span class="w"> </span><span class="n">PID</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">getProcFromPort</span><span class="p">(</span><span class="n">DWORD</span><span class="w"> </span><span class="n">port</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">json</span><span class="w"> </span><span class="nf">geoLocate</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">traceRoute</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">json</span><span class="o">&gt;</span><span class="w"> </span><span class="n">geoTrace</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">DWORD</span><span class="p">,</span><span class="w"> </span><span class="n">DWORD</span><span class="o">&gt;</span><span class="w"> </span><span class="n">PORT2PID</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">DWORD</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">PID2PROC</span><span class="p">;</span>

<span class="w">	</span><span class="c1">// tracert stuff</span>

<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">HANDLE</span><span class="w"> </span><span class="n">hIcmpFile</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">DWORD</span><span class="w"> </span><span class="n">dwRetVal</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">SendData</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">LPVOID</span><span class="w"> </span><span class="n">ReplyBuffer</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">DWORD</span><span class="w"> </span><span class="n">ReplySize</span><span class="p">;</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">IP_OPTION_INFORMATION</span><span class="w"> </span><span class="n">ipOptions</span><span class="p">;</span>

<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initPIDCache</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initICMP</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">refreshTables</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">PMIB_TCPTABLE_OWNER_PID</span><span class="w"> </span><span class="nf">getTCPTable</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">refreshTCP</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">PMIB_UDPTABLE_OWNER_PID</span><span class="w"> </span><span class="nf">getUDPTable</span><span class="p">();</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">refreshUDP</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;SDK.h&quot;</span>
</pre></div>
